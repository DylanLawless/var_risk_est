\input{head.tex}

\begin{document}

\newcounter{myboxcounter}
\newcommand{\boxlabel}[1]{%
  \refstepcounter{myboxcounter}%
  \label{#1}%
}

\title{Quantifying prior probabilities for disease-causing variants reveals the top genetic contributors in inborn errors of immunity}

% in your preamble, before \author:
\newcommand{\QUANT}{1}
\newcommand{\GHI}{2}
\newcommand{\KISPIIMM}{3}
 \newcommand{\METAB}{4}
\newcommand{\LEEDS}{5}
\newcommand{\IPSNEO}{6}

\author[\QUANT]{Quant Group} 
\author[\GHI]{Simon Boutry}% \textsuperscript{†}}
\author[\GHI]{Ali Saadat}% \textsuperscript{†}} \textsuperscript{†}}
\author[\KISPIIMM]{Maarja Soomann}% \textsuperscript{†}} \textsuperscript{†}}
\author[\KISPIIMM]{Johannes Trück}
 \author[\METAB]{D. Sean Froese}
\author[\GHI]{Jacques Fellay}
\author[\LEEDS]{Sinisa Savic}% orcid.org/0000-0001-7910-0554
\author[\IPSNEO]{Luregn J. Schlapbach}
\author[\IPSNEO]{Dylan Lawless *%\thanks{Addresses for correspondence: \href{mailto:Dylan.Lawless@kispi.uzh.ch}{Dylan.Lawless@kispi.uzh.ch}}
}
% \textsuperscript{†}
\affil[\QUANT]{The quantitative omic epidemiology group.} 
\affil[\GHI]{Global Health Institute, School of Life Sciences, École Polytechnique Fédérale de Lausanne, Switzerland.}
\affil[\KISPIIMM]{Division of Immunology and the Children’s Research Center, University Children’s Hospital Zurich, University of Zurich, Zurich, Switzerland.}
 \affil[\METAB]{Division of Metabolism and Children’s Research Center, University Children’s Hospital Zürich, University of Zurich, Zurich, Switzerland.}
\affil[\LEEDS]{Leeds Institute of Rheumatic and Musculoskeletal Medicine, University of Leeds, Leeds, UK.}
\affil[\IPSNEO]{Department of Intensive Care and Neonatology, University Children's Hospital Zurich, University of Zurich, Zurich, Switzerland.}

\maketitle
\justify

%Abstract: 150 of 150. Main text:  3931 of 4000 (intro, result, discussion, conclusion). Display (4 figures / 2 tables) of 8 total. Extended display: x of 10. Note that this journal uses separate online methods.

\noindent\includegraphics[width=0.7\textwidth]{./images/var_risk_est_ci.pdf}

\noindent Graphical abstract.

\clearpage
%  \linenumbers
\begin{abstract} 

\noindent \textbf{Background}:
Accurate interpretation of genetic variants requires a quantitative estimate of how likely a variant is to contribute to disease, accounting for both observed and unobserved causal alleles across different inheritance modes.
\vspace{1em}

\noindent \textbf{Methods}:
We developed a statistical framework that computes genome-wide prior probabilities for variant classification by integrating population allele frequencies, disease classifications, and Hardy-Weinberg expectations across dominant, recessive, and X-linked inheritance. Bayesian modelling then combines these priors with individual-level data to produce credible intervals that quantify diagnostic confidence.
\vspace{1em}

\noindent \textbf{Results}:
The framework replaces categorical variant classification with continuous posterior probabilities that capture residual uncertainty from incomplete or missing genotype data. Demonstrations in three diagnostic scenarios show accurate quantification of variant-level disease relevance. Application to 557 genes implicated in inborn errors of immunity (IEI) generated a public database of prior probabilities. Integration with protein-protein interaction and immunophenotypic data revealed gene-level constraint patterns, and validation in national cohorts showed close agreement between predicted and observed case numbers.
\vspace{1em}

\noindent \textbf{Conclusions}:
Our method addresses a long-standing gap in clinical genomics by quantifying both observed and unobserved genetic evidence in disease diagnosis. It provides a reproducible probabilistic foundation for variant interpretation, clinical decision-making, and large-scale genomic analysis.
\footnote{
\noindent * Addresses for correspondence: \href{mailto:Dylan.Lawless@uzh.ch}{Dylan.Lawless@uzh.ch}.\\
% \noindent  \textsuperscript{† }These authors contributed equally and are listed alphabetically.\\
\textbf{Availability:} This data is integrated in public panels at 
% \url{https://switzerlandomics.ch/services/panelAppRexAi/} and 
\url{https://iei-genetics.github.io}.
The source code are accessible as part of the variant risk estimation project at \url{https://github.com/DylanLawless/var_risk_est} and IEI-genetics project at
\url{https://iei-genetics.github.io}.
The data is available from the Zenodo repository: 
\url{https://doi.org/10.5281/zenodo.15111583}
(VarRiskEst PanelAppRex ID 398 gene variants.tsv).
VarRiskEst is available under the MIT licence.
% \url{https://github.com/TheQuantGroup/QauntGroup}.
}
\vfill
\end{abstract}

\section{Introduction}
Accurately estimating the probability that a patient carries a disease-causing genetic variant remains a central challenge in clinical and statistical genetics. For over a century, attention has focused on identifying variants which are \ac{tp} and reducing \ac{fp}, while \ac{fn} and \ac{tn} have received comparatively little consideration. \ac{fn} arise when pathogenic variants are missed due to technical or interpretive limits, and \ac{tn} represent the vast background of benign variants. Although \ac{tn} have clear value in contexts such as cancer screening, their wider statistical and clinical relevance remains underused. From a probabilistic standpoint, \ac{fn} and \ac{tn} provide crucial information about what is not observed, what should be expected under baseline genetic assumptions, and how confident one can be in the absence of a pathogenic finding. In practice, variant interpretation still relies on deterministic tools. For instance, GATK is used for processing; Ensembl VEP, SnpEff, FAVOR, and WGSA perform variant effect prediction \cite{2024riccioVariantEffectPredictors}; and Exomiser and VarFish support interpretation \cite{2020ciprianiImprovedPhenotypeDrivenTool, 2020holtgreweVarFishComprehensiveDNA}. These tools focus on annotation and prioritisation but don't have access to the underlying probabilities.

Quantifying the risk that a patient inherits a disease-causing variant is a core problem in genomics. Classical approaches based on \ac{hwe} \cite{MayoCentury2008, AbramovsHardyWeinberg2020} have long provided the foundation for calculating variant probabilities. However, these models become more complex when extended to different \ac{moi}, such as \ac{ar}, \ac{ad}, or \ac{xl} disorders. In \ac{ar} diseases, risk depends on both homozygosity and compound heterozygosity, whereas a single allele can cause disease in \ac{ad} or \ac{xl} forms. Modern evidence shows that \ac{moi} can be further modulated by mechanisms including dominant negative effects, haploinsufficiency, mosaicism, and digenic or epistatic interactions \cite{zschocke_mendelian_2023}. Although \citet{karczewski2020mutational} advanced the field considerably, applying statistical genomics data across all \ac{moi} for any gene-disease combination remains unresolved. Recent disease-specific estimates, including Wilson disease, mucopolysaccharidoses, primary ciliary dyskinesia, and treatable metabolic disorders \cite{bick_estimating_2025, evans_estimating_2021}, as reviewed by \citet{hannah_using_2024}, demonstrate progress but remain limited in scope.

All existing approaches remain limited to single \ac{moi}, specific disorders, or narrow gene sets. An integrated model is needed to unify these perspectives and generate probabilities that can serve as informative priors in a Bayesian framework for variant and disease probability estimation. Such a framework extends classical \ac{hwe}-based methods, strengthens clinical interpretation by clarifying expected genetic outcomes, and enhances analytical models used in statistical genomics.

The resulting dataset from these necessary calculations also holds value for AI and reinforcement learning applications, providing an enriched version of the data underpinning frameworks such as AlphaFold \cite{jumper_highly_2021} and AlphaMissense \cite{cheng_accurate_2023}.

This gap has persisted largely due to the historical absence of harmonised reference datasets. Only recently have resources become available to enable rigorous genome-wide probability estimation, including population allele frequencies (gnomAD v4 \cite{karczewski2020mutational}), curated variant classifications (ClinVar \cite{landrum_clinvar_2018}), functional annotations (UniProt \cite{the_uniprot_consortium_uniprot_2025}), and pathogenicity prediction models (AlphaMissense \cite{cheng_accurate_2023}). We previously introduced PanelAppRex to integrate gene panel data from sources such as \ac{ge} PanelApp, ClinVar, and \ac{uniprot}, enabling structured, machine-readable datasets for variant discovery and interpretation \cite{lawless_panelapprex_2025, martin_panelapp_2019, landrum_clinvar_2018, the_uniprot_consortium_uniprot_2025}. Together, these advances now allow systematic modelling of the expected distribution of variant types, frequencies, and classifications across the genome.

In this study, we report genome-wide probabilities of disease observation across gene-disease combinations, focusing on known \ac{iei} genes, also referred to as \ac{pid} or monogenic inflammatory bowel disease genes \cite{poli_human_2025, lawless_panelapprex_2025, martin_panelapp_2019}. This well-defined genotype-phenotype set, comprising more than 500 gene-disease associations, provides a robust validation of clinical relevance. The latest \ac{iuis} classification and diagnostic guidelines \cite{poli_human_2025, bousfiha_2024_2025} serve as the benchmark reference. We hypothesised that by integrating curated annotations on population \ac{af}, disease phenotypes, \ac{moi} patterns, and variant classifications with \ac{hwe}-based calculations, it would be possible to estimate expected probabilities of disease-associated variants and derive quantitative confidence in genetic diagnosis using these priors.

\section{Results}
\subsection{Occurrence probability across disease genes}
\label{sec:pro_obs}
Our study integrated large-scale annotation databases with gene panels from PanelAppRex to systematically assess disease genes by \ac{moi} 
\cite{lawless_panelapprex_2025}. 
By combining population allele frequencies with ClinVar clinical classifications, we computed an expected occurrence probability for each SNV, representing the likelihood of encountering a variant of a specific pathogenicity for a given phenotype. We report these probabilities for 54,814 ClinVar variant classifications across 557 genes (linked dataset \cite{lawless_2025_15111584}).

%In practice, our approach computed a simple observation probability for every SNV across the genome and was applicable to any disease-gene panel. Here, 
We focused on panels related to Primary Immunodeficiency or Monogenic Inflammatory Bowel Disease, using PanelAppRex panel ID 398.
\textbf{Figure \ref{fig:p_varRisEst_summary_scores}} displays all reported ClinVar  variant classifications for this panel. The resulting natural scaling system (-5 to +5) accounts for the frequently encountered combinations of classification labels (e.g. benign to pathogenic).
The resulting dataset \cite{lawless_2025_15111584} is briefly shown in \textbf{Table \ref{tab:head_result_table}} to illustrate that our method yielded estimates of the probability of observing a variant for every particular ClinVar classification. 

\begin{table}[ht]
\centering

\caption{\textbf{Example output from the framework estimating variant occurrence probability for disease-associated genes.} The table shows the first several rows of results for 557 genes from PanelAppRex's panel (ID 398: Primary immunodeficiency or monogenic inflammatory bowel disease). ``ClinVar Significance'' lists the pathogenicity classification assigned by ClinVar, while ``Occurrence Prob'' represents the calculated probability of observing each variant class given the phenotype. The mode of inheritance (\ac{moi}) is gene-disease specific. Additional data, such as population allele frequency, are omitted for brevity. 
 \cite{lawless_2025_15111584}}
\label{tab:head_result_table} 
\centering
\resizebox{\ifdim\width>\linewidth\linewidth\else\width\fi}{!}{
\begin{tabular}[t]{lrlrllll}
\toprule
Gene & Panel ID & ClinVar Clinical Sig & GRCh38 Pos & HGVSc & HGVSp & \ac{moi} & Occurrence Prob\\
\midrule
ABI3 & 398 & Uncertain significance & 3:49210771 & c.47G>A & p.Arg16Gln & AR & 0.000000007\\
ABI3 & 398 & Uncertain significance & 3:49216678 & c.265C>T & p.Arg89Cys & AR & 0.000000005\\
ABI3 & 398 & Uncertain significance & 3:49217742 & c.289G>A & p.Val97Met & AR & 0.000000002\\
ABI3 & 398 & Uncertain significance & 3:49217781 & c.328G>A & p.Gly110Ser & AR & 0.000000002\\
ABI3 & 398 & Uncertain significance & 3:49217844 & c.391C>T & p.Pro131Ser & AR & 0.000000015\\
ABI3 & 398 & Uncertain significance & 3:49220257 & c.733C>G & p.Pro245Ala & AR & 0.000000022\\
... &  ... & ... & ... & ... & ... & ... & ... \\
\bottomrule
\end{tabular}}
\end{table}

\begin{figure}[ht]
  \centering
  \includegraphics[width=0.99\textwidth]{./images/p_varRisEst_summary_scores.pdf}
  \caption{\textbf{Summary of ClinVar clinical significance classifications in the \ac{pid} gene panel.} (A) Shows the numeric score coding for each classification (i.e. -5 benign to +5 pathogenic) as defined in methods Section \ref{sec:classification_score}. (B) Displays the stacked absolute count of classifications per gene. The same counts are shows as percentages per gene in (C). (D) For demonstration, the top 15 genes ranked by absolute count of pathogenic (score 5) variant classifications, indicating those most frequently occurring in the population as disease-causing.
  }
  \label{fig:p_varRisEst_summary_scores}
\end{figure} 
 
\subsection{Integrating observed true positives and unobserved false negatives into a single, actionable conclusion}
\label{sec:intregrate_tp_fn}

%Having established a probabilistic framework for estimating the prior probability of observing disease-associated variants under different inheritance modes, we then applied this model to an example patient to demonstrate its potential for clinical genetics. The algorithm first verified that all known variant positions had been sequenced, confirmed those observed as reference (true negatives), and identified any positions observed as variant (true positives). 
%It also flagged positions that were not assessable due to missing sequence data or failed \ac{qc}. These missing sites represent potential false negatives, as true variants at these positions cannot be confirmed or excluded.
%By jointly modelling the observed and unobserved space, the method yielded a calibrated, evidence-weighted probability that at least one damaging or otherwise relevant variant could be present genome-wide. In practice, the framework models all variant classifications, but the analysis here focuses on causal pathogenicity as the principal case for interpretation.

We applied the probabilistic framework to an example patient to illustrate its diagnostic utility. The model assessed all known variant positions, identifying reference sites as \ac{tn}, observed variants as \ac{tp}, and unsequenced or low-quality sites as potential \ac{fn}. By modelling both observed and unobserved evidence, the framework evaluated each variant in relation to all others to derive an evidence-weighted probability that a damaging allele is present in the genome. While the framework quantifies all variant classifications, the examples here focus on causal pathogenicity.

\subsection{Scenario one - complete coverage and simple diagnosis}
We present the results from three scenarios for an example single-case patient being investigated for the genetic diagnosis of \ac{iei} with severe autoinflammatory disease.
\textbf{Figure \ref{fig:plot_scenario_1_quant_uncert_ci}} shows the results of the first simple scenario, in which only one known pathogenic variant, \ac{nfkb1} \texttt{p.Ser237Ter}, was observed and all other previously reported genome-wide pathogenic positions were successfully sequenced and confirmed as reference. 
In this setting, the model assigned the full posterior probability to the observed allele, yielding 100\,\% confidence that all present evidence supported a single, true positive causal explanation. 
The most strongly supported observed variant was \texttt{p.Ser237Ter} (posterior: 0.594). 
The strongest (probability of observing) non-sequenced variant was a benign variant \texttt{p.Thr567Ile} (posterior: 0). 
The total probability of a causal diagnosis given the available evidence was 1 (95\% CI: 1--1) (\textbf{Table~\ref{tab:table_scenario_1_quant_uncert_ci}}). 

\subsection{Scenario two - incomplete coverage and complex diagnosis}

\textbf{Figure~\ref{fig:plot_scenario_2_quant_uncert_ci}} illustrates the second scenario, where the same pathogenic \ac{nfkb1} variant \texttt{p.Ser237Ter} was detected, but sequencing coverage was incomplete at three additional classified sites. Among these was the likely pathogenic splice-site variant \texttt{c.159+1G{\small\textgreater}A}, which was not captured in the sequencing data. The panels in \textbf{Figure~\ref{fig:plot_scenario_2_quant_uncert_ci}~(A-F)} show the incremental integration of observed and missing evidence, resulting in a posterior probability that reflects both confirmed findings and residual uncertainty. Supporting metrics and reporting conclusions are summarised in \textbf{Table~\ref{tab:table_scenario_2_quant_uncert_ci}} and \textbf{Table~\ref{tab:table_scenario_2_report}}.

Bayesian integration of all annotated alleles produced quantitative \ac{cri}s for pathogenic attribution that (i) preserve Hardy-Weinberg expectations, (ii) accommodate \ac{ad}, \ac{ar}, and \ac{xl} inheritance, and (iii) quantify uncertainty from unsequenced or failed-\ac{qc} sites.
\textbf{Figure~\ref{fig:plot_scenario_2_quant_uncert_ci}~(A)} depicts the prior distribution partitioned by observed or missing status and by causal evidence, coloured by ClinVar score. \textbf{Figure~\ref{fig:plot_scenario_2_quant_uncert_ci}~(B)} shows posterior normalisation, concentrating probability density on two high-evidence alleles. \textbf{Figure~\ref{fig:plot_scenario_2_quant_uncert_ci}~(C)} displays the per-variant posterior probability of being damaging and causal, highlighting the confirmed nonsense variant \texttt{p.Ser237Ter} and the missing splice-donor \texttt{c.159+1G{\small\textgreater}A}. \textbf{Figure~\ref{fig:plot_scenario_2_quant_uncert_ci}~(D)} restricts the view to causal candidates, showing posterior mass across these two variants. \textbf{Figure~\ref{fig:plot_scenario_2_quant_uncert_ci}~(E)} decomposes total damaging probability into observed (40,\%) and missing (34,\%) components, and \textbf{Figure~\ref{fig:plot_scenario_2_quant_uncert_ci}~(F)} summarises the gene-level posterior, with a median probability of 0.542 (95,\% \ac{cri}: 0.264-0.8).

Numerically, the present variant \texttt{p.Ser237Ter} contributes 0.399 of the posterior share and the missing splice-donor allele \texttt{c.159+1G{\small\textgreater}A} contributes 0.339, with remaining alleles contributing negligibly (\textbf{Table~\ref{tab:table_scenario_2_quant_uncert_ci}}). For this patient scenario, the probability of correct genetic diagnosis due to \ac{nfkb1} \texttt{p.Ser237Ter} is 0.542 (95,\% \ac{cri}: 0.264-0.8), reflecting the remaining uncertainty from an unconfirmed alternative allele. If the second variant is confirmed absent, the confidence increases to 1 (95,\% \ac{cri}: 1-1), consistent with scenario one.

% \input{"./images/table_scenario_2_final_report.tex"}

\begin{table}[h]
\centering
\caption{Final variant report for clinical genetics scenario 2. Reported causal: \texttt{p.Ser237Ter} (posterior 0.377). Undetected causal: \texttt{c.159+1G>A} (posterior 0.364). The total probability of a causal diagnosis given the available evidence was 0.511 (95\% CI: 0.237--0.774).\label{tab:table_scenario_2_report}}
\centering
\resizebox{\ifdim\width>\linewidth\linewidth\else\width\fi}{!}{
\begin{tabular}[t]{>{\raggedright\arraybackslash}p{4cm}>{\raggedright\arraybackslash}p{6cm}>{\raggedright\arraybackslash}p{6cm}}
\toprule
Parameter & present & missing\\
\midrule
Gene & NFKB1 & NFKB1\\
HGVSc & c.710C>G & c.159+1G>A\\
HGVSp & p.Ser237Ter & .\\
Inheritance & AD & AD\\
Patient sex & Male & Male\\
gnomAD frequency & 6.57e-06 & 6.57e-06\\
95\% CI lower & 0.003 & NA\\
p(median) & 0.090 & NA\\
95\% CI upper & 0.551 & NA\\
Posterior p(causal) & 0.377 & 0.364\\
Interpretation & Reported causal; variant observed & Reported causal; variant not detected — consider follow‑up\\
\midrule
\textbf{Summary} & \multicolumn{2}{p{10cm}}{Overall probability of correct causal diagnosis due to SNV/INDEL given the currently available evidence: 0.511 (95\% CI 0.237--0.774). } \\
\bottomrule
\end{tabular}}
\end{table}

\begin{figure}[h]
  \centering
  \includegraphics[width=0.85\textwidth]{./images/plot_scenario_2_quant_uncert_ci.pdf}
  \caption{\textbf{Quantifying diagnostic certainty from genomic evidence.}
Example of \textit{NFKB1} (scenario 2) with observed (\ac{tp}) and missing (\ac{fn}) causal variants. The proband carried three heterozygous variants, including pathogenic \texttt{p.Ser237Ter}, with incomplete coverage at three loci, including splice-site variant \texttt{c.159+1G{\small\textgreater}A}. Panels show: (A) prior occurrence probabilities; (B) posterior variant weights \(\tilde{\pi}_i\); (C) per-variant posterior probability of being damaging and causal; (D) posterior for causal variants; (E) decomposition of total pathogenic probability into observed (green) and missing (orange) components; and (F) the final posterior probability that a damaging allele is present (median 0.54, 95\,\% \ac{cri} 0.26-0.80). Results are compared to \textbf{Table \ref{tab:table_scenario_2_report}}.
%and scenarios one and three in Figures~\ref{fig:plot_scenario_1_quant_uncert_ci} and~\ref{fig:plot_scenario_3_quant_uncert_ci}.
}
  \label{fig:plot_scenario_2_quant_uncert_ci}
\end{figure}

\subsection{Scenario three - currently impossible diagnosis}

\textbf{Figure~\ref{fig:plot_scenario_3_quant_uncert_ci}} shows the third scenario, where no observed variants were detected in the proband for \ac{nfkb1}. Instead, a broad range of plausible \ac{fn}s were identified as missing for \ac{tnfaip3}. The strongest of these unsequenced variants was \texttt{p.Cys243Arg} (posterior: 0.347). However, the total probability of a causal diagnosis for the patient \emph{given the available evidence} was 0 (95,\% CI: 0-0), since these missing variants must be explicitly accounted for (\textbf{Table~\ref{tab:table_scenario_3_quant_uncert_ci}}). Upon confirmation, these probabilities can update as shown in scenario two.

\subsection{Posterior probabilities quantify competing variant hypotheses}

The three scenarios deliberately remove the distraction of other genome-wide candidate variants, which are assumed as present and accounted for within the model. In practice, the same posterior probability and \ac{cri} calculations are performed across all qualifying variants. 
%and multiple variants often carry non-negligible probabilities in real diagnostic settings.
In real-world diagnostics, we commonly find multiple variants to carry non-negligible probabilities. 
Our framework explicitly quantifies these competing hypotheses, enabling a ranked interpretation that reflects the totality of evidence. 
Overlapping \ac{cri} do not indicate ambiguity in the method, but rather a principled measure of remaining uncertainty. 
This output can directly inform follow-up actions, such as functional validation or treatment trials, and supports the use of CrI thresholds as a transparent decision-making aid when data are incomplete or equivocal.

\subsection{Quantifying variant probabilities improves classification of inborn errors of immunity}

\subsubsection*{Genes with high pathogenic variant burden show structured network constraint}

%\subsubsection*{Genetic constraint in high-impact protein networks}
We applied the framework to \ac{iei}, a disease area 
% in which we have expertise and
which offers a well-curated gene set to validate genome-wide estimates and demonstrate potential applications \cite{poli_human_2025}. Because pathogenicity in \ac{iei} often reflects shared molecular pathways, we integrated ClinVar-derived variant probabilities with \ac{ppi} data to quantify per-gene pathogenic burden and assess whether constraint clusters within specific networks, consistent with known \ac{iei} categories and immunophenotypes \cite{szklarczyk2025string, karczewski2020mutational}.

%\subsubsection*{Score-positive-total reveals genes with the highest pathogenic variant burden}
ClinVar classifications (\textbf{Figure \ref{fig:p_varRisEst_summary_scores}}) were scaled from -5 to +5 by pathogenicity. 
We summed all positive (potentially damaging) scores per gene to derive the score-positive-total metric. 
\textbf{Figure \ref{fig:ppi_network_assoc} (A)} shows the \ac{ppi} network, with node size and colour proportional to this metric (log-transformed). 
The top 15 genes with the highest total prior probabilities of disease association are labelled, consistent with \textbf{Figure \ref{fig:p_varRisEst_summary_scores}}.

% \subsubsection*{Variant burden varies across IEI categories but without significant pairwise differences}
One-way \ac{anova} indicated that major \ac{iei} categories differed in score-positive-total values (\(F(8,500)=2.82,\,p=0.0046\)), suggesting uneven distributions of pathogenic variant burden (\textbf{Figure \ref{fig:ppi_network_assoc} (B)}). 
However, Tukey \ac{hsd} post hoc tests (\textbf{Figure \ref{fig:ppi_network_assoc} (C)}) showed overlapping 95\% \ac{ci}s for all pairwise comparisons, indicating that category-level differences were not individually significant.


\FloatBarrier
\subsubsection*{Constrained subnetworks reveal distinct functional disease signatures}

% \subsubsection*{UMAP projection separates constrained hub genes from variant-enriched subnetworks}
To visualise the \ac{ppi} network, we applied \ac{umap} projection (\textbf{Figure~\ref{fig:p_umap}}). Node size indicates connectivity, and colours show cluster membership \cite{szklarczyk2025string}. Blue labels mark hub genes (top 5\% by degree), and yellow labels mark the 15 genes with the highest damaging variant load. Genes enriched for pathogenic variants were distinct from highly connected nodes, indicating that \ac{lof} in hubs is constrained, while damaging variants in less connected genes have more specific effects.

\begin{figure}[h]
  \centering
  \includegraphics[width=0.8\textwidth]{./images/untangleR_ppi_network_umap.pdf}
  \caption{
    \textbf{\ac{umap} embedding of the \ac{ppi} network.} 
    Projection of the high-dimensional protein interaction network into two dimensions. Nodes are coloured by cluster and scaled by interaction degree. Blue labels denote hub genes (degree above the 95th percentile) and yellow labels mark the top 15 genes by score-positive-total (damaging ClinVar classifications). The separation indicates that genes with high pathogenic variant loads differ from highly connected nodes.
  }
  \label{fig:p_umap}
\end{figure}

% \FloatBarrier

% \subsubsection*{Complement and bone marrow failure genes cluster within high-burden protein subnetworks}
\textbf{Figure~\ref{fig:patch2}} shows standardised residuals for major disease categories across clusters corresponding to \textbf{Figure~\ref{fig:p_umap}}. The dendrogram groups categories with similar enrichment patterns, and the bar plot highlights the strongest signals. \ac{cd} (8) and \ac{bmf} (9) showed the highest enrichment, indicating that their genes cluster in subnetworks with a high burden of damaging variants. All categories exceeded nominal significance (\(|\mathrm{residual}| > 2\)), reflecting concentrated variant effects in specific clusters, notably cluster 4 for category 8.


% \subsubsection*{Gene connectivity and LOEUF constraint reveal pathway-specific intolerance}
Building on these findings, we tested the relationship between \ac{ppi} connectivity (degree) and \ac{lof} constraint (\ac{loeuf} rank) \cite{karczewski2020mutational}. A weak but significant negative correlation ($\rho=-0.181$, $p=0.00024$) indicated that highly connected genes tend to be more constrained. Cluster-level analyses revealed stronger relationships, for example cluster 2 ($\rho=-0.375$, $p=0.000994$) and cluster 4 ($\rho=-0.800$, $p<0.000001$), suggesting shared mechanisms of \ac{lof} intolerance within specific pathways (\textbf{Figure~\ref{fig:p_cor_spear_rho_sig_clust_patch3}}). The score-positive-total metric effectively summarised aggregate pathogenic burden and selective constraint.


% \subsubsection*{New insight from functional enrichment}
Functional enrichment using MsigDB and FUMA \cite{watanabe_functional_2017} linked clusters 2 and 4 to distinct disease pathways (\textbf{Figure~\ref{fig:fuma_merge}}). Cluster 2 was enriched for inflammatory and autoimmune traits, including ankylosing spondylitis, psoriasis, inflammatory bowel disease, and rheumatoid arthritis. Cluster 4 was associated with complement and ocular phenotypes, such as macular degeneration, complement biomarkers, nephropathy, and pulmonary traits. GTEx v8 tissue expression data (\textbf{Figure~\ref{fig:expHeatmaps}}) supported these patterns, showing that variant burden and network constraint together define mechanistic disease relationships that extend established classifications.

\subsubsection*{Accounting for genome-wide relationships and linkage disequilibrium}

\textbf{Figure \ref{fig:karyo_locusplot_merged} (A)} presents a genome-wide karyoplot of all \ac{iei} panel genes mapped to GRCh38, coloured by \ac{moi}. 
Panels \textbf{(B)} and \textbf{(C)} show regional locus plots for \textit{NFKB1} and \textit{CFTR}. 
In \textbf{(B)}, only benign variants such as p.Ala475Gly display high observation probabilities in the \ac{ad} gene \textit{NFKB1}, which is highly intolerant to \ac{lof}. 
In contrast, \textbf{(C)} shows elevated probabilities for pathogenic variants in \textit{CFTR}, consistent with its well-established disease association. 
Analysis of \ac{ld} using $\text{R}^2$ demonstrates that regions of high linkage can be effectively modelled, enabling separation of independent variant signals within complex loci.

\begin{figure}[ht]
  \centering
  \includegraphics[width=0.99\textwidth]{./images/karyo_locusplot_merged.pdf}
  \caption{\textbf{Genome-wide \ac{iei}, variant occurrence probability and \ac{ld} by $\text{R}^2$.} (A) Genome-wide karyoplot of all \ac{iei} panel genes mapped to GRCh38, with colours indicating \ac{moi}. (B) Zoomed-in locus plot example for \textit{NFKB1} showing variant occurrence probabilities; only benign variants such exhibit high probabilities in this \ac{ad} gene intolerant to \ac{lof}. (C) Locus plot example for \textit{CFTR} displaying high probabilities for pathogenic variants; due to the dense clustering of pathogenic variants, score filter >0 was applied. Top five variants are labelled per gene.}
  \label{fig:karyo_locusplot_merged}
\end{figure}

% \FloatBarrier

\subsubsection*{Data-driven classification of PID genes}

Immunophenotypic data from the \ac{iuis} \ac{iei} tables link genes to clinical immune phenotypes but are variable and incomplete. They nonetheless provide a foundation for reproducible, data-driven classification of \ac{iei} genes. Using the estimated probabilities of disease observation from variant classification likelihoods, we simplified 315 immunophenotypic features from free-text descriptions into binary categories (normal vs.\ not-normal) for T cells, B cells, \ac{ig}, and neutrophils (\textbf{Figure~\ref{fig:immunophenotype_before_after}}). Mapping these features to STRINGdb \ac{ppi} clusters showed significant non-random associations ($\chi^2 < 1e{-13}$; \textbf{Figure~\ref{fig:plot_multicat_patch_3_clust_chi}}), indicating that network structure captures major immunophenotypic patterns. Predictive accuracy rose from 33\% using phenotypes alone to 61\% when combined with \ac{iuis} categories (\textbf{Figure~\ref{fig:multicat_performance_combined}}), with \ac{ig} and T-cell abnormalities as top predictors. The final \ac{ppi}-immunophenotype model, dependent on the underlying probability of disease observation, defined 17 data-driven PID groups (33 with full \ac{iuis} categories; \textbf{Figure~\ref{fig:pid_class_tree_distribution}}). This approach advances classification from qualitative expert assessment to reproducible, data-driven grouping of related disorders.




\begin{figure}[ht]
  \centering
  \includegraphics[width=0.9\textwidth]{./images/p_new_classification_finetune_tree.pdf}       
  \includegraphics[width=0.9\textwidth]{./images/plot_new_pid_classifications_genetic.pdf}
  \includegraphics[width=0.9\textwidth]{./images/plot_multicat_new_pid_classes_combined.pdf}
\caption{\textbf{Data-driven model integrating variant probability and refining PID classifications.}
(Top) Decision tree grouping genes into 17 new PID classes based on immunophenotypic, \ac{ppi}, and variant occurrence features, including LOEUF constraint. Each node summarises gene count, class probabilities, and sample fraction.
(Middle) Distribution of the 17 PID classes, labelled by predominant abnormal immune features (e.g.\ T cell, B cell, Ig, Neutrophil).
(Bottom) Extended model incorporating traditional \ac{iuis} \ac{iei} categories. This quantitative taxonomy unites variant probability, gene constraint, and immune phenotype into a scalable, machine-readable framework.}
  \label{fig:pid_class_tree_distribution}
\end{figure}

% \FloatBarrier

\subsection{Observed variant likelihood is independent of AlphaMissense pathogenicity}
AlphaMissense (and similar tools) assigns pathogenicity scores to all possible amino acid substitutions, yet \textbf{Figure~\ref{fig:alphamissense}} shows that variants most frequently observed in patients are predominantly benign or of uncertain significance. This highlights the gap between predicting pathogenic potential and estimating how likely a variant is to occur, providing a quantitative basis for improving predictive models.
Comparison of \textbf{Figure~\ref{fig:alphamissense}~(A)} with \textbf{Figure~\ref{fig:p_varRisEst_summary_scores}~(D)} illustrates the distribution of classifications.
A Kruskal-Wallis test (\textbf{Figure~\ref{fig:alphamissense_kw}}) found no meaningful differences in variant observation probability across AlphaMissense classification groups. This indicates that current pathogenicity predictors estimate how damaging a variant may be, but not how likely it is to be observed in patients. The weak inverse trends likely reflect underlying effects of \ac{moi} and \ac{lof} intolerance.

\begin{figure}[ht]
\begin{center}
%    \includegraphics[width=0.99\textwidth]{./images/p_alphamissense_RAG1.pdf}
    \includegraphics[width=0.8\textwidth]{./images/p_alphamissense_NFKB1.pdf}
    \includegraphics[width=0.8\textwidth]{./images/p_alphamissense_CFTR.pdf}
\end{center}
\caption{\textbf{Variant observation probabilities and AlphaMissense pathogenicity scores.} 
For each gene, the upper plot (A) displays variant observation probabilities and the lower plot (B) shows AlphaMissense-derived pathogenicity scores across all amino acid substitutions. Although AlphaMissense predicts the functional impact of every substitution, the variants most frequently observed in patients are mainly benign or of uncertain significance. This illustrates that pathogenicity prediction captures functional effect but not likelihood of occurrence, highlighting the complementary nature of these probability measures. *Axis scaling adjusted for visibility near zero; higher values indicate higher observation probability.}
 \label{fig:alphamissense}
\end{figure}

\subsection{Integration of variant observation probabilities into the IEI genetics framework}

We integrated prior probabilities of variant observation across all \ac{iei} genes linked to each phenotype \cite{poli_human_2025}, spanning \ac{ad}, \ac{ar}, and \ac{xl}  \ac{moi}. These gene-level priors, derived from curated PanelAppRex panels, quantify disease-gene relationships and extend the \ac{iei} genetics framework. The outputs include machine- and human-readable datasets and a web interface (\url{https://iei-genetics.github.io}) integrating these probabilities with clinical and functional data (\textbf{Figure~\ref{fig:var_risk_est_iei_genetics}}). Each record displays summary statistics, sparkline box plots, and dynamic links to external resources (e.g.\ ClinVar, \ac{omim}, AlphaFold) for direct bioinformatic use \cite{lawless_2025_15111584}.

\FloatBarrier

\section{Discussion}

% 1. Occurrence probability across disease genes
We present, to our knowledge, the first genome-wide framework for quantifying prior probabilities of observing disease-associated variants and for performing evidence-aware genetic diagnosis with \ac{cri} \cite{hannah_using_2024, bick_estimating_2025}. By integrating population allele frequencies (\ac{gnomad}) \cite{karczewski2020mutational}, curated classifications (ClinVar) \cite{landrum_clinvar_2018}, and functional annotations (\ac{dbnsfp}), with classical \ac{hwe}-based models, we derived probabilistic estimates for 54,814 ClinVar variant classifications across 557 \ac{iei} genes linked to \ac{pid} and monogenic inflammatory bowel disease \cite{lawless_panelapprex_2025, poli_human_2025}. 
Although demonstrated in \ac{iei}, the framework generalises to all inheritance modes: \ac{ad} and \ac{xl} requiring a single pathogenic allele, and \ac{ar} involving homozygous or compound heterozygous variants. These \ac{hwe}-based priors provide a baseline for Bayesian inference, now feasible at scale through comprehensive genomic databases \cite{landrum_clinvar_2018, karczewski2020mutational, lawless_panelapprex_2025, cheng_accurate_2023}.

% 2. Integrating observed true positives and unobserved false negatives into a single actionable conclusion
A persistent limitation in clinical genetics is the focus on confirming only observed \ac{tp} variants. Our framework addresses this by integrating both observed and unobserved evidence into a single quantitative conclusion. We derived per-variant priors across all \ac{moi} and combined these with the patient's genotype data to yield posterior probabilities representing the likelihood of carrying a damaging causal allele. This approach provides a clinically interpretable probability that unifies confirmed and potentially missed variants. Incidentally, the score-positive-total metric offers a practical, evidence-based method for ranking candidate genes and guiding diagnosis in phenotypically overlapping cases.

% 0. Deficiencies
Our current framework had several limitations. It focuses primarily on \ac{snv}s and does not yet incorporate structural variants, de novo mutations, hypomorphic alleles, overdominance, variable penetrance, tissue-specific effects, or phenomena such as the Wahlund effect and pleiotropy \cite{zschocke_mendelian_2023}. Future extensions could include factors such as embryonic lethality, condition-specific penetrance, and age of onset \cite{hannah_using_2024}. The present analysis also assumes random mating, large population size, and no migration, mutation, or selection.  
We demonstrated genome-wide gene distribution and \ac{moi} for the \ac{iei} panel in relation to \ac{ld}, confirming both feasibility and relevance. However, accurate \ac{ld} estimation requires population-specific, genome-wide pairwise genotype data. Our use of global reference allele frequencies improves generalisability but may reduce precision relative to population-specific estimates.
The integration of \ac{iuis}-derived immunophenotypic data in the novel PID groupings assumes that simplified categorisation improves their suitability for computational rather than intuitive interpretation. Although the underlying \ac{iuis} annotations are variable and incomplete, and in some disorders such as GATA2 deficiency reflect secondary rather than primary effects, this approach represents a step toward data-driven rather than intuition-based disease classification.

% 3. Scenario one - simple diagnosis
% 4. Scenario two - complex diagnosis
% 5. Scenario three - currently impossible diagnosis
Across diagnostic scenarios, the framework quantified the probability that any variant, regardless of classification, is both observed and relevant to disease. This enabled confident attribution to present variants while accounting for counterfactual and unsequenced but plausible sites. Scenario two exemplified how confirmed and missing evidence jointly shape diagnostic confidence. Unlike conventional approaches that consider only observed findings, the framework captures residual uncertainty and produces structured, ``evidence-aware'' conclusions. Combined with genome-wide priors from PanelAppRex, it provides a scalable foundation for probabilistic, evidence-aware diagnostics across phenotypes.


%% Probability model
%Estimating disease risk in genetic studies is complicated by uncertainties in key parameters such as variant penetrance and the fraction of cases attributable to specific variants \cite{zschocke_mendelian_2023}. 
%In the simplest model, where a single, fully penetrant variant causes disease, the lifetime risk \(P(D)\) is equivalent to the genotype frequency \(P(G)\). 
%For an allele with frequency \(p\) (ignoring \ac{ld} for \ac{ar}), this translates to:
%
%\[
%\begin{aligned}
%\text{Autosomal Recessive:} \quad P(D) &= p^2, \\
%\text{Autosomal Dominant:} \quad P(D) &= 2p(1-p) \approx 2p.
%\end{aligned}
%\]
%
%When penetrance is incomplete, defined as \(P(D\mid G)\), the risk becomes:
%$P(D) = P(G)\,P(D\mid G).$
%In more realistic scenarios where multiple variants contribute to disease, \(P(G\mid D)\) denotes the fraction of cases attributable to a given variant. This leads to:
%
%\[
%P(D) = \frac{P(G)\,P(D\mid G)}{P(G\mid D)}.
%\]
%% 6. Validation studies
%Because both penetrance and \(P(G\mid D)\) are often uncertain, solving this equation systematically poses a major challenge, which we incidentally tackled in the validation studies
%\cite{minikel_quantifying_2016, whiffin_using_2017}. % Eric's \url{https://www.cureffi.org/2019/06/05/using-genetic-data-to-estimate-disease-prevalence/}.
%
%Our framework addresses this challenge by combining variant classifications, population allele frequencies, and curated gene-disease associations. 
%While imperfect on an individual level, these sources exhibit predictable aggregate behaviour, supported by James-Stein estimation principles \cite{efron_steins_1973}.
%% Keep this thought here: Stein's Estimation Rule and its competitors, as discussed by Efron and Morris (1973), demonstrate that shrinkage estimators, such as the James-Stein estimator, can outperform traditional maximum likelihood methods by “borrowing strength” across multiple parameters. In essence, even if individual estimates are noisy or imprecise, shrinking them towards a common value (or mean) improves the overall risk (mean squared error) of the estimates. This empirical Bayes approach shows that aggregate estimates tend to be well-calibrated, a principle we leverage in our work: although individual ClinVar variant classifications may be uncertain, their collective behaviour yields robust and reliable prior probabilities when combined with population allele frequencies and curated gene-disease associations.
%Curated gene-disease associations help identify genes that are explainable for most disease cases, allowing us to approximate \(P(G\mid D)\) close to one. In this way, we obtain robust estimates of \(P(G)\) (the frequency of disease-associated genotypes), even when exact values of penetrance and case attribution remain uncertain.
%
%This approach allows us to pre-calculate priors and summarise the overall pathogenic burden.
%By focusing on a subset \(\mathcal{V}\) of variants that pass stringent filtering, where each \(P(G_i \mid D)\) is the probability that a case of disease \(D\) is attributable to variant(s) \(i\), we assume that, in aggregate,
%
%\[
%\sum_{i\in\mathcal{V}} P(G_i\mid D) \approx 1.
%\]
%
%Even if the cumulative contribution is slightly less than one, the resultant risk estimates remain robust within the broad \ac{cri}s typical of epidemiological studies. 
%By incorporating these pre-calculated priors into a Bayesian framework, our method refines risk estimates and enhances clinical decision-making despite inherent uncertainties.

Estimating genetic disease risk is complicated by uncertainty in penetrance and the fraction of cases attributable to specific variants \cite{zschocke_mendelian_2023}.
In probabilistic terms, \(P(D)\) is the population risk of disease, \(P(G)\) is the frequency of a given genotype, \(P(D\mid G)\) is the penetrance (the probability of disease given that genotype), and \(P(G\mid D)\) is the proportion of affected individuals carrying that genotype.  
In the simplest case of a single, fully penetrant allele, the lifetime risk \(P(D)\) equals the genotype frequency \(P(G)\), given by \(P(D)=p^2\) for autosomal recessive and \(P(D)=2p(1-p)\approx2p\) for autosomal dominant inheritance.
With incomplete penetrance \(P(D\mid G)\), the relationship becomes
\[
P(D)=P(G)\,P(D\mid G).
\]
When multiple variants contribute, the proportion of cases attributable to each variant is described by \(P(G\mid D)\), giving  
\[
P(D)=\frac{P(G)\,P(D\mid G)}{P(G\mid D)}.
\]

Both \(P(D\mid G)\) and \(P(G\mid D)\) are rarely known precisely \cite{minikel_quantifying_2016, whiffin_using_2017}. Our framework addresses this by integrating variant classifications, allele frequencies, and curated gene-disease associations. While individual estimates are uncertain, their aggregate behaviour is well-calibrated under James-Stein estimation principles \cite{efron_steins_1973}, allowing reliable priors for Bayesian inference.
%% Keep this comment thought here: Stein's Estimation Rule and its competitors, as discussed by Efron and Morris (1973), demonstrate that shrinkage estimators, such as the James-Stein estimator, can outperform traditional maximum likelihood methods by “borrowing strength” across multiple parameters. In essence, even if individual estimates are noisy or imprecise, shrinking them towards a common value (or mean) improves the overall risk (mean squared error) of the estimates. This empirical Bayes approach shows that aggregate estimates tend to be well-calibrated, a principle we leverage in our work: although individual ClinVar variant classifications may be uncertain, their collective behaviour yields robust and reliable prior probabilities when combined with population allele frequencies and curated gene-disease associations.

Curated gene-disease associations identify loci that explain most cases, permitting approximation of \(P(G\mid D)\approx1\) and stable estimation of \(P(G)\), the frequency of disease-associated genotypes. For a filtered subset of variants \(\mathcal{V}\), where each has probability \(P(G_i\mid D)\), we assume
\(
\sum_{i\in\mathcal{V}} P(G_i\mid D)\approx1.
\)
Even if this sum is slightly less than one, resulting risk estimates remain robust within typical credible intervals. These pre-computed priors provide a quantitative foundation for refining disease probability and diagnostic confidence through Bayesian integration.

% Data-driven classification of PID genes
% 11. Integration of variant probabilities into the IEI genetics framework
% 7. Genetic constraint in high-impact protein networks
% Our results refine risk calculations by incorporating \ac{moi} complexities and enhances clinicians’ understanding of expected variant occurrences, thereby improving diagnostic precision.
% For the \ac{iei}-specific analysis, we demonstrated that immunophenotypic and network-derived features can jointly predict \ac{ppi} structure, enabling data-driven refinement of gene classifications. Simplified immune features (e.g.\ “T cell low”) were retained in our public database, while detailed cluster assignments were excluded due to their complexity. These results illustrate how structured annotations can support automated or machine learning-based analyses in larger cohorts.  

% Because variant sets can be aggregated rather than limited to single-gene analyses, our framework complements established rare variant association tests such as \ac{skat} and \ac{acat} \cite{liu2019acat,li2020dynamic,wu2011rare,lee2012optimal}, and aligns with multi-omics integration approaches \cite{kong2018nature,howe2021within}. It remains compatible with \ac{acmg} guidelines \cite{richards2015standards}, related frameworks \cite{tavtigian2020fitting,li2017intervar}, and existing \ac{qc} standards \cite{pedersen2021effective,anderson2010data}. Standardised reporting systems, including \ac{acmg} Secondary Findings v3.2 \cite{miller2023acmg}, provide context for embedding these probabilistic results in clinical workflows.  

By aggregating variant sets beyond single-gene analyses, the framework complements established rare variant association tests such as \ac{skat} and \ac{acat} \cite{liu2019acat,li2020dynamic,wu2011rare,lee2012optimal} and aligns with multi-omics integration methods \cite{kong2018nature,howe2021within}. It is compatible with \ac{acmg} guidelines \cite{richards2015standards}, related interpretation frameworks \cite{tavtigian2020fitting,li2017intervar}, and current \ac{qc} standards \cite{pedersen2021effective,anderson2010data}. Standardised systems, including \ac{acmg} Secondary Findings v3.2 \cite{miller2023acmg}, allow integration of these probabilistic results into clinical workflows.
Comparison with AlphaMissense scores showed that pathogenicity predictors estimate molecular effect rather than probability of occurrence. Integrating variant-level priors with predictors like AlphaMissense could improve disease relevance by incorporating gene-disease associations  and \ac{moi} for applications in AI/ML.

Future work should extend this framework to additional variant classes and models, iteratively updating classical estimates with new data to refine probabilistic diagnostics and support more precise clinical decision-making.

\section{Conclusion}

We present a statistical framework that quantifies the probability that any variant contributes to disease by integrating observed genotypes with the possibility of unobserved alleles. It replaces binary classifications with continuous posterior probabilities and credible intervals reflecting evidence and uncertainty. 
% Combining population genetics, inheritance, and Bayesian inference, it enables inference from incomplete data and provides a reproducible measure of diagnostic probability at gene, panel, or genome level. 
Although illustrated in \ac{iei}, the approach is generalisable to all diseases and supports quantitative genomic interpretation at scale.

\section*{Acknowledgements}
\noindent
We would like to thank all the patients and families who have been providing advice on SwissPedHealth and its projects, as well as the clinical and research teams at the participating institutions.
We acknowledge Genomics England for providing public access to the PanelApp data.
The use of data from Genomics England panelapp was licensed under the Apache License 2.0.
The use of data from \ac{uniprot} was licensed under Creative Commons Attribution 4.0 International (CC BY 4.0).
ClinVar asks its users who distribute or copy data to provide attribution to them as a data source in publications and websites \cite{landrum_clinvar_2018}.
\ac{dbnsfp} version 4.4a is licensed under the Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0); while we cite this dataset as used our research publication, it is not used for the final version which instead used ClinVar and \ac{gnomad} directly.
GnomAD is licensed under  Creative Commons  Zero Public Domain Dedication (CC0 1.0 Universal).
GnomAD request that usages cites the \ac{gnomad} flagship paper \cite{karczewski2020mutational}
and any online resources that include the data set provide a link to the browser, and note that tool includes data from the \ac{gnomad} v4.1 release.
AlphaMissense asks to cite \citet{cheng_accurate_2023} for usage in research, with data available from \citet{jun_cheng_2023_8208688}.

\section*{Contributions}
\noindent 
DL designed the analyses and wrote the manuscript.
SB, AS, MS, and JT designed analysis and wrote the manuscript.
DSF, and SS wrote the manuscript.
JF, LJS supervised the work, and applied for funding.
The Quant Group is a collaboration across multiple institutions where authors contribute equally; the members on this project were DL, SB, and AS.

\section*{Competing interest}
\noindent
The authors declare no competing interest. 

\section*{Ethics statement}
\noindent
This study only used data which was previously published and publicly available, as cited in the manuscript.
This  SwissPedHealth study, under which this work was carried out, was approved based on the advice of the ethical committee Northwest and Central Switzerland (EKNZ, AO\_2022-00018). 
The study was conducted in accordance with the Declaration of Helsinki.

\section*{Data availability}

The data used in this manuscript is derived from open sources which are cited in methods. The data generated is available from the Zenodo repository: \url{https://doi.org/10.5281/zenodo.15111583}.
The resulting data are also reproducible using the code repository \url{https://github.com/DylanLawless/var_risk_est}.

\section*{Funding}
\noindent This project was supported through the grant Swiss National Science Foundation (SNF) 320030\_201060, and NDS-2021-911 (SwissPedHealth) from the Swiss Personalized Health Network and the Strategic Focal Area `Personalized Health and Related Technologies' of the ETH Domain (Swiss Federal Institutes of Technology).

\clearpage
\section{Methods}
\subsection{Dataset}
Data from \ac{gnomad} v4 comprised 807,162 individuals, including 730,947 exomes and 76,215 genomes \cite{karczewski2020mutational}. 
This dataset provided 786,500,648 \ac{snv}s and 122,583,462 \ac{indel}s, with variant type counts of 9,643,254 synonymous, 16,412,219 missense, 726,924 nonsense, 1,186,588 frameshift and 542,514 canonical splice site variants. ClinVar data were obtained from the variant summary dataset (as of: 16 March 2025) available from the NCBI FTP site, and included 6,845,091 entries, which were processed into 91,319 gene classification groups and a total of 38,983 gene classifications; for example, the gene \textit{A1BG} contained four variants classified as likely benign and 102 total entries \cite{landrum_clinvar_2018}. For our analysis phase we also used \ac{dbnsfp} which consisted of a number of annotations for 121,832,908 \ac{snv}s 
\cite{liu_dbnsfp_2020}. 
The PanelAppRex core model contained 58,592 entries consisting of 52 sets of annotations, including the gene name, disease-gene panel ID, diseases-related features, confidence measurements.
\cite{lawless_panelapprex_2025}
\ac{ppi} network data was provided by \ac{stringdb}, consisting of 19,566 proteins and 505,968 interactions \cite{szklarczyk2025string}.
The \ac{hgvs} nomenclature is used with \ac{vep}-based codes for variant IDs.
AlphaMissense includes pathogenicity prediction classifications for 71 million variants in 19 thousand human genes \cite{cheng_accurate_2023, jun_cheng_2023_8208688}. We used these scores to compared against the probability of observing the same given variants.
\textbf{Box \ref{box:definitions}} list the definitions from the \ac{iuis} \ac{iei} for the major disease categories used throughout this study \cite{poli_human_2025}.

The following genes were used for disease cohort validations and examples.
We used the two most commonly reported genes from the \ac{iei} panel \ac{nfkb1} 
\cite{tuijnenburgNFKB12018,
who1997primary,
cunningham1999common,
oksenhendler2008infections}
and \ac{cftr} 
\cite{naito2023uk, castellani2013cftr2, Grasemann2023cftr}
to demonstrate applications in \ac{ad} and \ac{ar} disease genes, respectively.
We used \ac{scid}-specific genes 
\ac{ar} \ac{dclre1c},
\ac{ar} \ac{rag1},
\ac{xl} \ac{il2rg} to demonstrate a \ac{iei} subset disease phenotype of 
\ac{scid}.
We also used \ac{ad} \ac{tnfaip3} for other examples comparable to \ac{nfkb1} since it is also causes \ac{ad} pro-inflammatory disease but has more known ClinVar classifications at higher \ac{af} then \ac{nfkb1}.




\begin{tcolorbox}[
    colback=white!0,
    colframe=black!70,
    boxrule=1pt,
    arc=1mm,
    outer arc=1mm,
    title=\textbf{\refstepcounter{myboxcounter}\label{box:definitions}Box \themyboxcounter: definitions}
]
% \begin{tcolorbox}[colback=black!01, colframe=black!70, title=Box \ref{box:definitions} Definitions for IEI Major Disease Categories, label=box:definitions]
\textbf{Major Category} \hspace{4em} \textbf{Description}\\[5pt]
1. CID  Immunodeficiencies affecting cellular and humoral immunity\\[2pt]
2. CID+  Combined immunodeficiencies with associated or syndromic features\\[2pt]
3. PAD - Predominantly Antibody Deficiencies\\[2pt]
4. PIRD - Diseases of Immune Dysregulation\\[2pt]
5. PD - Congenital defects of phagocyte number or function\\[2pt]
6. IID - Defects in intrinsic and innate immunity\\[2pt]
7. AID - Autoinflammatory Disorders\\[2pt]
8. CD - Complement Deficiencies\\[2pt]
9. BMF - Bone marrow failure
\end{tcolorbox}

\subsection{Variant classification occurrence probability}
To quantify the likelihood that an individual harbours a variant with a given disease classification, we compute the variant-level occurrence probability (\ac{vre}) for each variant.
As a starting point, we considered the classical \ac{hwe} for a biallelic locus:
$
p^2 + 2pq + q^2 = 1,
$
where \(p\) is the allele frequency, \(q = 1 - p\), \(p^2\) represents the homozygous dominant, \(2pq\) the heterozygous, and \(q^2\) the homozygous recessive genotype frequencies. For disease phenotypes, particularly under \ac{ar} \ac{moi}, the risk is traditionally linked to the homozygous state (\(p^2\)); however, to account for compound heterozygosity across multiple variants, %we extend this by incorporating the contribution from other pathogenic alleles.
we allocated the overall gene-level risk proportionally among variants.

Our computational pipeline estimated the probability of observing a disease-associated genotype for each variant and aggregated these probabilities by gene and ClinVar classification. This approach included all variant classifications, not limited solely to those deemed ``pathogenic'', and explicitly conditioned the classification on the given phenotype, recognising that a variant could only be considered pathogenic relative to a defined clinical context. The core calculations proceeded as follows:

\paragraph{1. Allele frequency and total variant frequency.} 
\label{sec:min_risk}
For each variant \(i\) in a gene, the allele frequency was denoted as \(p_i\). For each gene (any genomic region or set), we defined the total variant frequency (summing across all reported variants in that gene) as:
$P_{\text{tot}} = \sum_{i \in \text{gene}} p_i$.
Note that, because each calculation is confined to one gene, no additional scaling was required for our primary analyses (\(P_{\text{tot}}\)). However, if this same unscaled summation is applied across regions or variant sets of differing size or dosage sensitivity, it can bias burden estimates. In such cases, normalisation by region length or incorporation of gene- or region-specific dosage constraints is recommended.

If any of the possible \ac{snv}  had no observed allele (\(p_i = 0\)), we assigned a minimal risk:
$p_i = \frac{1}{\max(AN) + 1}$
where \(\max(AN)\) was the maximum allele number observed for that gene. This adjustment ensured that a nonzero risk was incorporated even in the absence of observed variants in the reference database.

\paragraph{2. Occurrence probability based on \ac{moi}.}
The probability that an individual is affected by a variant depends on the \ac{moi}. For \textbf{\ac{ad}} and \textbf{\ac{xl}} variants, a single pathogenic allele suffices:
$p_{\text{disease},i} = p_i$.
For\textbf{ \ac{ar}} variants, disease manifests when two pathogenic alleles are present, either as homozygotes or as compound heterozygotes. We use:
$p_{\text{disease},i} = p_i \; P_{\text{tot}}$. % version 2

Under \ac{hwe}, the overall gene-level probability of an \ac{ar} genotype is
$P_{\text{AR}} \;=\; P_{\text{tot}}^2
\;=\;\sum_i p_i^2 \;+\; 2\sum_{i<j} p_i\,p_j$,
where \(P_{\text{tot}}=\sum_i p_i\). A naïve per-variant assignment
$p_i^2 + 2\,p_i\,(P_{\text{tot}} - p_i)$
would, when summed over all \(i\), double-count the compound heterozygous terms. 
To partition \(P_{\text{AR}}\) among variants without double counting, we allocate risk in proportion to each variant’s allele frequency:
$
p_{\text{disease},i}
=\frac{p_i}{P_{\text{tot}}}\times P_{\text{tot}}^2
= p_i\,P_{\text{tot}}$.

This ensures
$
\sum_i p_{\text{disease},i}
= \sum_i p_i\,P_{\text{tot}}
= P_{\text{tot}}^2,
$
recovering the correct \ac{ar} risk while attributing each variant its fair share of homozygous and compound-heterozygous contributions.

More simply, for \ac{ad} or \ac{xl} conditions a single pathogenic allele suffices, so the classification risk (e.g. benign, pathogenic) equals its population frequency. For \ac{ar} conditions two pathogenic alleles are required - either two copies of the same variant or one copy each of two different variants, so we divide the overall recessive risk among variants according to each variant’s share of the total classification frequency in that gene.

\paragraph{3. Expected case numbers and case detection probability.}
Given a population with \(N\) births (e.g. as seen in our validation studies, \(N = 69\,433\,632\)), the expected number of cases attributable to variant \(i\) was calculated as:
$E_i = N \cdot p_{\text{disease},i}$.
The probability of detecting at least one affected individual for that variant was computed as:
$P(\geq 1)_i = 1 - \bigl(1 - p_{\text{disease},i}\bigr)^N$.

\paragraph{4. Aggregation by gene and ClinVar classification.}
For each gene and for each ClinVar classification (e.g. ``Pathogenic'', ``Likely pathogenic'', ``Uncertain significance'', etc.), we aggregated the results across all variants. The classification grouping can be substituted by any alternative score system. The total expected cases for a given group was:
$E_{\text{group}} = \sum_{i \in \text{group}} E_i$,
and the overall probability of observing at least one case within the group was calculated as:
$P_{\text{group}} = 1 - \prod_{i \in \text{group}} \left(1 - p_{\text{disease},i}\right)$.

\paragraph{5. Data processing and implementation.}
We implemented the calculations within a \ac{hpc} pipeline and provided an example for a single dominant disease gene, \textit{TNFAIP3}, in the source code to enhance reproducibility. Variant data were imported in chunks from the annotation database for all chromosomes (1-22, X, Y, M). 

For each data chunk, the relevant fields were gene name, position, allele number, allele frequency, ClinVar classification, and HGVS annotations. 
Missing classifications (denoted by ``.'') were replaced with zeros and allele frequencies were converted to numeric values. % We then retained only the first transcript allele annotation for simplicity, as the analysis was based on genomic coordinates. 
Subsequently, the variant data were merged with gene panel data from PanelAppRex to obtain the disease-related \ac{moi} mode for each gene. 
For each gene, if no variant was observed for a given ClinVar classification (i.e. \(p_i = 0\)), a minimal risk was assigned as described above. 
Finally, we computed the occurrence probability, expected cases, and the probability of observing at least one case of disease using the equations presented.

The final results were aggregated by gene and ClinVar classification and used to generate summary statistics that reviewed the predicted disease observation probabilities.
We define the \emph{\ac{vre}} as the prior probability of observing a variant classified as the cause of disease 

\paragraph{6. Score-positive-total.}
For use as a simple summary statistic on the resulting user-interface, we defined the \emph{score-positive-total} as the total number of positively scored variant classifications within a given region (gene, locus, or variant set). 
Using the ClinVar classification assigned to a scale from$-5$ (benign) to $+5$ (pathogenic), we included only scores $> 0$, corresponding to some evidence of pathogenicity. 
The score-positive-total yields a non-normalised estimate of the prior probability that a phenotype is explained by known pathogenic variants.

\paragraph{7. Classification scoring system.}
\label{sec:classification_score}
Each ClinVar classification was assigned an integer score: pathogenic = +5, likely pathogenic = +4, pathogenic (low penetrance) = +3, likely pathogenic (low penetrance) = +2, conflicting pathogenicity = +2, likely risk allele/risk factor/association = +1, drug response/uncertain significance/no classification/affects/other/not provided/uncertain risk allele = 0, protective = -3, likely benign = -4, benign = -5. No further normalisation was applied. The resulting distribution (\textbf{Figure \ref{fig:p_gene_summary_hist_patch3} A-B}) is naturally comparable to a zero-centred average rank (\textbf{C-D}). This straightforward, modular approach can be readily replaced by any comparable evidence-based classification system. Variants with scores  $\leq 0$ were omitted, since benign classifications do not inform disease likelihood in the score-positive-total summary.

% --------------------------------------------------------------------------
% Methods, Results and Discussion: gene‑level pathogenic attribution
% --------------------------------------------------------------------------

\subsection{Bayesian framework for posterior probability of genetic diagnosis}

We developed a Bayesian framework to estimate the probability that at least one variant in a given genome or target set is both present and clinically relevant in a proband. The method combines variant-specific priors derived from any classification system or scoring scheme with a probabilistic model of genotype presence, incorporating both observed and unsequenced genomic positions.

\paragraph{Prior specification.}
Each variant \( i \) was assigned a prior probability \( p_i \) reflecting its likelihood of being relevant to the user's target interpretation. This could include, for example, being classified as pathogenic, benign, or uncertain significance, or being prioritised by a quantitative scoring scheme. The priors may be derived from allele frequency, expert curation, functional prediction, or any other source of variant-level evidence. The framework supports modular priors without constraint. % accurate diagnostic inference generally requires gene‑disease information, including the \ac{moi}, to determine whether one or multiple variants are needed to explain the phenotype.
In our implementation, priors are derived from ClinVar classification, gnomAD population frequency, and \ac{moi} specified with PanelAppRex gene-disease curation. We modelled the latent causality of each variant as a Beta distribution parameterised by
$\alpha_i = \text{round}(p_i \cdot A_N) + w$, 
$\beta_i = A_N - \text{round}(p_i \cdot A_N) + 1$,
where \( A_N \) is the total number of callable alleles at the site (e.g. \( A_N = 2n \) for \( n \) diploid individuals), and \( w \) is a small stabilising constant (typically \( w = 1 \)). This construction reflects the expected frequency of the variant in the tested cohort under the assumption of causal relevance.

\paragraph{Posterior simulation.}
We drew \( N = 10{,}000 \) samples from the Beta prior to approximate a posterior distribution for each variant:
$\theta_i^{(m)} \sim \text{Beta}(\alpha_i, \beta_i), \quad m = 1,\dots,N$.
In each simulation round, these values were normalised across all variants to reflect the relative share of the total causal signal:
$$
\tilde{\theta}_i^{(m)} = \frac{\theta_i^{(m)}}{\sum_j \theta_j^{(m)}}, \qquad \hat{P}_i = \frac{1}{N} \sum_{m=1}^{N} \tilde{\theta}_i^{(m)}.
$$

This yields a posterior expectation of variant-level contribution, which can be thresholded or ranked depending on the application.

\paragraph{Genotype presence model.}
Independently from the classification or interpretive context, each variant was assigned a probability \( q_i \in [0,1] \) of being present in the proband. For observed alternate genotypes, \( q_i = 1 \); for confidently called reference genotypes, \( q_i = 0 \); and for unsequenced or uncertain sites, \( q_i \) was set to the prior probability \( p_i \), or an alternative estimate reflecting presence likelihood.
For each simulation round, we drew a genotype indicator:
$G_i^{(m)} \sim \text{Bernoulli}(q_i)$,
and computed the total interpreted variant probability:
$
T^{(m)} = \sum_i G_i^{(m)} \cdot \tilde{\theta}_i^{(m)}$.
The empirical distribution of \( \{T^{(m)}\} \) represents the posterior belief that the proband harbours at least one variant matching the specified interpretive criteria in the given gene or set. Summary statistics, such as the posterior median and 95\% credible interval, are used to report this probability with interval-based accountability.

\paragraph{Flexibility and implementation.}
This framework generalises across different scoring systems, prior models, and sequencing contexts. It can incorporate uncertain classifications, variant weights, unsequenced positions, or alternative genotype priors without altering the core inference structure. The method is implemented in R with modular inputs and reproducible simulation logic.

\subsection{Application to diagnostic scenarios with observed and unobserved variant data}
% \subsection{Integrating observed true positives and unobserved false negatives into a single, actionable conclusion}

In this section, we detail our approach to integrating sequencing data with prior classification evidence (e.g. pathogenic on ClinVar) to calculate the posterior probability of a complete successful genetic diagnosis.
Our method is designed to account for possible outcomes of 
\ac{tp},
% \ac{fp},
\ac{tn},
and \ac{fn},
by first ensuring that all nucleotides corresponding to known variant classifications (benign, pathogenic, etc.) have been accurately sequenced. 
This implies the use of \ac{gvcf}-style data which refer to \ac{vcf}s that contain a record for every position in the genome (or interval of interest) regardless of whether a variant was detected at that site or not.
Only after confirming that these positions match the reference alleles (or novel unaccounted variants are classified) do we calculate the probability that additional, alternative pathogenic variants (those not observed in the sequencing data) could be present. 
Our \ac{cri} for pathogenicity thus incorporates uncertainty from the entire process, including the tally of \ac{tp}, \ac{tn}, and \ac{fn} outcomes.
We ignore the contribution of \ac{fp}s  as a separate task to be tackled in the future.

We estimated, for every query (e.g. gene or disease-panel), the posterior probability that at least one constituent allele is both damaging and causal in the proband.  
The workflow comprises four consecutive stages.

\paragraph{(i) Data pre‑processing.}
We synthesized an example patient in a disease cohort of 200 cases.
We made several scenarios where a causal genetic diagnosis based on the available data is either simple, difficult, or impossible.
Our example focused on a proband two representative genes for \ac{ad} \ac{iei}: \ac{nfkb1} and  \ac{tnfaip3}.
All coding and canonical splice‑region variants for \ac{nfkb1} were extracted from the gVCF.  
We assumed a typical \ac{qc} scenario, where sites corresponding to previously reported pathogenic alleles were checked for read depth \mbox{$\ge\!10$} and genotype quality \mbox{$\ge\!20$}.  
Positions that failed this check were labelled \emph{missing}, thus separating true reference calls from non-sequenced or uninformative sequence.

\paragraph{(ii) Evidence mapping and occurrence probability.}
PanelAppRex variants were annotated with ClinVar clinical significance.  Each label was converted to an ordinal evidence score $S_i\in[-5,5]$ and rescaled to a pathogenic weight $W_i=\operatorname{rescale}(S_i;\,-5,5\rightarrow0,1)$.  
This scoring system can be replaced with any comparable alternative.
The HWE-based pipeline of Section \ref{sec:min_risk} supplied a per‑variant occurrence probability $p_i$.  The adjusted prior was
$p_{i}^{\ast}=W_i\,p_i,$ and
$\mathrm{flag}_i\in\{\text{present},\text{missing}\}$.

\paragraph{(iii) Prior specification.}
In a hypothetical cohort of $n=200$ diploid individuals the count of allele~$i$ follows a Beta-Binomial model.  Marginalising the Binomial yields the Beta prior
$\pi_i\sim\mathrm{Beta}\!\bigl(\alpha_i,\beta_i\bigr)$,
$\alpha_i=\mathrm{round}(2np_{i}^{\ast})+\tilde w_i,\;
\beta_i = 2n-\mathrm{round}(2np_{i}^{\ast})+1$,
where $\tilde w_i=\max(1,S_i+1)$ contributes an additional pseudo‑count whenever $S_i>0$.

\paragraph{(iv) Posterior simulation and aggregation.}
For each variant $i$ we drew $M=10\,000$ realisations $\pi_{i}^{(m)}$ and normalised within each iteration,
$\tilde\pi_{i}^{(m)}=\frac{\pi_{i}^{(m)}}{\sum_{j}\pi_{j}^{(m)}}$.
Variants with $S_i>4$ were deemed to have evidence as \emph{causal} (pathogenic or likely pathogenic). 
We note that an alternative evidence score or conditional threshold can be substituted for this step.
Their mean posterior share $\bar\pi_i=M^{-1}\sum_m\tilde\pi_{i}^{(m)}$ and $95\%$ \ac{cri} were retained.  The probability that a damaging causal allele is physically present was obtained by a second layer:
$P^{(m)}=\sum_{i:\,S_i>3}\tilde\pi_{i}^{(m)}\,G_{i}^{(m)}$, and
$G_{i}^{(m)}\sim\mathrm{Bernoulli}(g_i)$,
with $g_i=1$ for present variants, $g_i=0$ for reference calls, and $g_i=p_i$ for missing variants.  The gene‑level estimate is the median of $\{P^{(m)}\}_{m=1}^{M}$ and its $2.5^{\text{th}}$/$97.5^{\text{th}}$ percentiles.

\paragraph{(v) Scenario analysis.}
The three scenarios were explored for a causal genetic diagnosis that is either simple, difficult, or impossible given the existing data.
The proband spiked data had either:
(1) known classified variants only, including only one known \ac{tp} pathogenic variant, \ac{nfkb1}  \texttt{p.Ser237Ter}, 
(2) inclusion of an additional plausible yet non-sequenced splice‑donor allele \ac{nfkb1}  \texttt{c.159+1G{\small\textgreater}A} (likely pathogenic) as a \ac{fn}, and 
(3) where no known causal variants were present for a patient, one representative variant from each distinct ClinVar classification was selected and marked as unsequenced to emulate a range of putative \acp{fn}. The selected variants were: \ac{tnfaip3} \texttt{p.Cys243Arg} (pathogenic), \texttt{p.Tyr246Ter} (likely pathogenic), \texttt{p.His646Pro} (conflicting interpretations of pathogenicity), \texttt{p.Thr635Ile} (uncertain significance), \texttt{p.Arg162Trp} (not provided), \texttt{p.Arg280Trp} (likely benign), \texttt{p.Ile207Leu} (benign/likely benign), and \texttt{p.Lys304Glu} (benign). 
All subsequent steps were identical.

\subsection{Validation of autosomal dominant estimates using \textit{NFKB1}}

To validate our genome-wide probability estimates in an \ac{ad} gene, we focused on \ac{nfkb1}. 
Our goal was to compare the expected number of \ac{nfkb1}-related \ac{cvid} cases, as predicted by our framework, with the reported case count in a well-characterised national-scale \ac{pid} cohort.

\paragraph{1. Reference dataset.}
We used a reference dataset reported by \citet{tuijnenburgNFKB12018} to build a validation model in an \ac{ad} disease gene. This study performed whole-genome sequencing of 846 predominantly sporadic, unrelated \ac{pid} cases from the NIHR BioResource-Rare Diseases cohort. There were 390 \ac{cvid} cases in the cohort. The study identified \ac{nfkb1} as one of the genes most strongly associated with \ac{pid}. Sixteen novel heterozygous variants including truncating, missense, and gene deletion variants, were found in \ac{nfkb1} among the \ac{cvid} cases.

\paragraph{2. Cohort prevalence calculation.}
Within the cohort, 16 out of 390 \ac{cvid} cases were attributable to \ac{nfkb1}. 
Thus, the observed cohort prevalence was
$
\text{Prevalence}_{\text{cohort}} = \frac{16}{390} \approx 0.041$,
with a 95\% confidence interval (using Wilson's method) of approximately \((0.0254,\,0.0656)\).

\paragraph{3. National estimate based on literature.}
Based on literature
\cite{tuijnenburgNFKB12018, who1997primary, oksenhendler2008infections},
the prevalence of \ac{cvid} in the general population was estimated as
$\text{Prevalence}_{\text{CVID}} = \frac{1}{25\,000}$.
For a UK population of  $N_{\text{UK}} \approx 69\,433\,632,$
the expected total number of \ac{cvid} cases was
$E_{\text{CVID}} \approx \frac{69\,433\,632}{25\,000} \approx 2777.$
Assuming that the proportion of \ac{cvid} cases attributable to \ac{nfkb1} is equivalent to the cohort estimate, the literature extrapolated estimate is
$\text{Estimated NFKB1 cases} \approx 2777 \times 0.041 \approx 114$,
with a median value of approximately 118 and a 95\% confidence interval of 70 to 181 cases (derived from posterior sampling).

\paragraph{4. Bayesian adjustment.}
Recognising that the sequenced cohort cases likely captures the majority of \ac{nfkb1}‑related patients (apart from close relatives), but may still miss rare or geographically dispersed variants, we combined the cohort-based and literature-based estimates using two complementary Bayesian approaches:

\begin{enumerate}
  \item \textbf{Weighted adjustment (emphasising the cohort, \(w=0.9\)):}  
  We assigned \(90\%\) weight to the directly observed cohort count (16) and \(10\%\) to the extrapolated population estimate (114), thereby accounting, illustratively, for a small fraction of unobserved cases while retaining confidence in our well‑characterised cohort:
$  \text{Adjusted Estimate}
    = 0.9 \times 16 \;+\; 0.1 \times 114
    \;\approx\; 26$,
  yielding a 95\% \ac{cri} of roughly 21 to 33 cases.
  \item \textbf{Mixture adjustment (equal weighting, \(w=0.5\)):}  
  To reflect greater uncertainty about how representative the cohort is, we combined cohort and population prevalences equally. 
  We sampled from the posterior distribution of the cohort prevalence,
   $p \sim \mathrm{Beta}(16 + 1,\,390 - 16 + 1)$,
  and mixed this with the literature-based rate at \(50\%\) each \cite{tuijnenburgNFKB12018, who1997primary, oksenhendler2008infections}. 
  This yields a median estimate of 67 cases and a wider 95\% \ac{cri} of approximately 43 to 99 cases, capturing uncertainty in both under-ascertainment and over-generalisation.
\end{enumerate}

\paragraph{5. Predicted total genotype counts.}
The predicted total synthetic genotype count (before adjustment) was 456, whereas the predicted total genotypes adjusted for \texttt{synth\_flag} was 0. 
This higher synthetic count was set based on a minimal risk threshold, ensuring that at least one genotype is assumed to exist (e.g. accounting for a potential unknown de novo variant) even when no variant is observed in gnomAD (as per \textbf{section
\ref{sec:min_risk}}).

\paragraph{6. Validation test.}
Thus, the expected number of \ac{nfkb1}-related \ac{cvid} cases derived from our genome-wide probability estimates was compared with the observed counts from the UK-based \ac{pid} cohort. 
This comparison validates our framework for estimating disease incidence in \ac{ad} disorders.

% Annotated key values from R:
% Predicted total genotypes (adjusted for synth_flag): 0 
% Predicted total synthetic genotype count: 456 
% Reported NFKB1-related CVID cases (n_NFKB1): 16 
% Literature extrapolated estimate median: 118 
% 95% CI for literature extrapolated estimate: [70, 181] 
% Bayesian mixture adjusted estimate (w = 0.5) median: 67 
% 95% CI for Bayesian mixture adjusted estimate: [43, 99] 
% Bayesian adjusted estimated number of NFKB1-related CVID cases (w = 0.9): 26 
% 95% Bayesian adjusted CI (w = 0.9): [21, 33]

\subsection{Validation study for autosomal recessive CF using \textit{CFTR}}

To validate our framework for \ac{ar} diseases, we focused on \ac{cf}.
For comparability sizes between the validation studies, we analysed the most common \ac{snv} in the \ac{cftr} gene, typically reported as \texttt{p.Arg117His} (GRCh38 Chr 7:117530975 G/A, MANE Select HGVSp ENST00000003084.11: p.Arg117His).
Our goal was to validate our genome-wide probability estimates by comparing the expected number of \ac{cf} cases attributable to the \texttt{p.Arg117His} variant in \ac{cftr} with the nationally reported case count in a well-characterised disease cohort
\cite{naito2023uk, castellani2013cftr2, Grasemann2023cftr}.

\paragraph{1. Expected genotype counts.}
Let \( p \) denote the allele frequency of the \texttt{p.Arg117His} variant and \( q \) denote the combined frequency of all other pathogenic \ac{cftr} variants, such that
$q = P_{\text{tot}} - p \quad \text{with} \quad P_{\text{tot}} = \sum_{i \in \text{CFTR}} p_i$.
Under Hardy-Weinberg equilibrium for an \ac{ar} trait, the expected frequencies were:
$f_{\text{hom}} = p^2$ (homozygous for p.Arg117His)
and
$f_{\text{comphet}} = 2p\,q$ 
(compound heterozygotes carrying p.Arg117His and another pathogenic allele).
For a population of size \( N \) (here, \( N \approx 69\,433\,632 \)), the expected number of cases were:
$E_{\text{hom}} = N \cdot p^2,\quad E_{\text{comphet}} = N \cdot 2p\,q,\quad E_{\text{total}} = E_{\text{hom}} + E_{\text{comphet}}$.

\paragraph{2. Mortality adjustment.}
Since \ac{cf} patients experience increased mortality, we adjusted the expected genotype counts using an exponential survival model \cite{naito2023uk, castellani2013cftr2, Grasemann2023cftr}. With an annual mortality rate \(\lambda \approx 0.004\) and a median age of 22 years, the survival factor was computed as:
$S = \exp(-\lambda \cdot 22)$.
Thus, the mortality-adjusted expected genotype count became:
$E_{\text{adj}} = E_{\text{total}} \times S$.

\paragraph{3. Bayesian uncertainty simulation.}
To incorporate uncertainty in the allele frequency \( p \), we modelled \( p \) as a beta-distributed random variable:
\[
p \sim \mathrm{Beta}(p \cdot \text{AN}_{\text{eff}} + 1,\; \text{AN}_{\text{eff}} - p \cdot \text{AN}_{\text{eff}} + 1),
\]
using a large effective allele count (\(\text{AN}_{\text{eff}}\)) for illustration. 
By generating 10,000 posterior samples of \( p \), we obtained a distribution of the literature-based adjusted expected counts, \(E_{\text{adj}}\).

\paragraph{4. Bayesian Mixture Adjustment.}
Since the national registry may not capture all nuances (e.g., reduced penetrance) of \ac{cftr}-related disease, we further combined the literature-based estimate with the observed national count (714 cases from the UK Cystic Fibrosis Registry 2023 Annual Data Report) using a 50:50 weighting:
\[
E_{\text{Bayes}} = 0.5 \times (\text{Observed Count}) + 0.5 \times E_{\text{adj}}.
\]

\paragraph{5. Validation test.}
Thus, the expected number of \ac{cftr}-related \ac{cf} cases derived from our genome-wide probability estimates was compared with the observed counts from the UK-based \ac{cf} registry. This comparison validated our framework for estimating disease incidence in \ac{ad} disorders.

\subsection{Validation of SCID-specific estimates using PID-SCID genes}

To validate our genome-wide probability estimates for diagnosing a genetic variant in a patient with an \ac{pid} phenotype, we focused on a subset of genes implicated in \ac{scid}. Given that the overall panel corresponds to PID, but SCID represents a rarer subset, the probabilities were converted to values per million PID cases.

\paragraph{1. Incidence conversion.}
Based on literature, \ac{pid} occurs in approximately 1 in 1,000 births, whereas \ac{scid} occurs in approximately 1 in 100,000 births. 
Consequently, in a population of 1,000,000 births there are about 1,000 \ac{pid} cases and 10 \ac{scid} cases. 
To express \ac{scid}-related variant counts on a per-million \ac{pid}  scale, the observed \ac{scid} counts were multiplied by 100. 
For example, if a gene is expected to cause \ac{scid} in 10 cases within the total \ac{pid} population, then on a per-million \ac{pid}  basis the count is 10 × 100 = 1,000 cases (across all relevant genes).

\paragraph{2. Prevalence calculation and data adjustment.}
For each SCID-associated gene (e.g. \textit{IL2RG}, \textit{RAG1}, \ac{dclre1c}), the observed variant counts in the dataset were adjusted by multiplying by 100 so that the probabilities reflect the expected number of cases per 1,000,000 \ac{pid}. 
In this manner, our estimates are directly comparable to known counts from SCID cohorts, rather than to national population counts as in previous validation studies.

\paragraph{3. Integration with prior probability estimates.}
The predicted genotype occurrence probabilities were derived from our framework across the \ac{pid} gene panel. 
These probabilities were then converted to expected case counts per million  \ac{pid} cases by multiplying by 1,000,000. 
For instance, if the probability of observing a pathogenic variant in \textit{IL2RG} is \(p\), the expected \ac{scid}-related count becomes \(p \times 10^6\). Similar conversions are applied for all relevant \ac{scid} genes.

\paragraph{4. Bayesian Uncertainty and Comparison with Observed Data.}
To address uncertainty in the \ac{scid}-specific estimates, a Bayesian uncertainty simulation was performed for each gene to generate a distribution of predicted case counts on a per-million \ac{pid} scale. 
The resulting median estimates and 95\% \ac{cri}s were then compared against known national \ac{scid} counts compiled from independent registries. 
This comparison permuted a direct evaluation of our framework’s accuracy in predicting the occurrence of \ac{scid}-associated variants within a \ac{pid} cohort.

\paragraph{5. Validation Test.}
Thus, by converting the overall probability estimates to a per-million \ac{pid} scale, our framework was directly validated against observed counts for \ac{scid}. %This procedure confirms that our probability estimation approach can be effectively adapted to specific subphenotypes within a broader disease spectrum, ensuring robust application for both global PID and SCID diagnostics.

\subsection{Protein network and genetic constraint interpretation}
A \ac{ppi} network was constructed using protein interaction data from \ac{stringdb} \cite{szklarczyk2025string}. We previously prepared and reported 
on this dataset consisting of 19,566 proteins and 505,968 interactions 
(\url{https://github.com/DylanLawless/ProteoMCLustR}).
Node attributes were derived from log-transformed score-positive-total values, which informed both node size and colour. Top-scoring nodes (top 15 based on score) were labelled to highlight prominent interactions. To evaluate group differences in score-positive-total across major disease categories, one-way \ac{anova} was performed followed by Tukey \ac{hsd} post hoc tests (and non-parametric Dunn’s test for confirmation). 
GnomAD v4.1 constraint metrics data was used for the \ac{ppi} analysis and was sourced from \citet{karczewski2020mutational}.
This provided transcript-level metrics, such as observed/expected ratios, \ac{loeuf}, \ac{pli}, and Z-scores, quantifying \ac{lof} and missense intolerance, along with confidence intervals and related annotations for 211,523 observations.

\subsection{Gene set enrichment test}

To test for overrepresentation of biological functions, the prioritised genes were compared against gene sets from MsigDB (including hallmark, positional, curated, motif, computational, GO, oncogenic, and immunologic signatures) and WikiPathways using hypergeometric tests with FUMA \cite{watanabe_functional_2017, liberzon_molecular_2011}.
The background set consisted of 24,304 genes. Multiple testing correction was applied per data source using the Benjamini-Hochberg method, and gene sets with an adjusted P-value $\le$ 0.05 and more than one overlapping gene are reported.

\subsection{Deriving data-driven classifications of PID genes}
To enable reproducible, data-driven grouping of \ac{iei} disease genes, we integrated curated clinical annotations with molecular network features. The goal was to formalise immunophenotypic descriptors into a structured format suitable for computational classification, complementing traditional \ac{iuis} categories.
We recategorised 315 immunophenotypic features from the original \ac{iuis} \ac{iei} annotations, reducing the original multi-level descriptors (e.g. ``decreased CD8, normal or decreased CD4'') first to 
minimal labels (e.g.``low'') and second to binary outcomes (normal vs. not-normal) for T cells, B cells, neutrophils, and immunoglobulins %(\textbf{Figure \ref{fig:immunophenotype_before_after}}). 
Each gene was mapped to its \ac{ppi} cluster derived from \ac{stringdb} and \ac{umap} embeddings from previous steps. 
We first tested for non-random associations between these four binary immunophenotypes and \ac{ppi} clusters using $\chi^2$ tests. %(see Figure \ref{fig:multicat_patch_3_clust_chi}). 
To generate a data-driven PID classification, we trained a decision tree (rpart) to predict \ac{ppi} cluster membership from the four immunophenotypic features plus the traditional \ac{iuis} Major and Subcategory labels. 
Hyperparameters (complexity parameter = 0.001, minimum split = 10, minimum bucket = 5, maximum depth = 30) were optimised via five-fold cross validation using the \texttt{caret} framework. 
Terminal node assignments were then relabelled according to each group’s predominant abnormal feature profile.

\subsection{Probability of observing AlphaMissense pathogenicity}
We obtained the subset pathogenicity predictions from AlphaMissense via the AlphaFold database and whole genome data from the studies data repository\cite{cheng_accurate_2023, jun_cheng_2023_8208688}. 
The AlphaMissense data (genome-aligned and amino acid substitutions) were merged with the panel variants based on genomic coordinate and HGVSc annotation. 
Occurrence probabilities were log-transformed and adjusted (y-axis displaying log10(occurrence prob + 1e-5) + 5)), to visualise the distribution of pathogenicity scores across the residue sequence. 
A Kruskal-Wallis test was used to compare the observed disease probability across clinical classification groups.

\subsection{Probability model definitions}
Estimating disease risk requires accounting for both variant penetrance, $P(D\mid G)$, where $D$ denotes the disease state and $G$ the genotype, and the fraction of cases attributable to a given variant, $P(G\mid D)$. In a fully penetrant single-variant model ($P(D\mid G)=1$), the lifetime risk $P(D)$ equals the genotype frequency $P(G)$. For an allele with population frequency $p$, this gives $P(D)=p^2$ for a recessive mode of inheritance and $P(D)=2p(1-p)\approx2p$ for a dominant mode. With incomplete penetrance, $P(D)=P(G)\,P(D\mid G)$, and when multiple variants contribute to disease,  

\[
P(D)=\frac{P(G)\,P(D\mid G)}{P(G\mid D)}.
\]

Because both $P(D\mid G)$ and $P(G\mid D)$ are often uncertain, we integrate ClinVar clinical classifications, population allele frequencies and curated gene-disease associations, assuming James-Stein shrinkage to derive robust aggregate priors. By focusing on a filtered set of variants $\mathcal{V}$ where each $P(G_i\mid D)$ is the probability that disease $D$ is attributable to variant $i$ and assuming $\sum_{i\in\mathcal{V}}P(G_i\mid D)\approx1$, we obtain calibrated estimates of genotype frequency $P(G)$ despite uncertainty in individual parameters. 


\clearpage
% \newpage
\bibliographystyle{unsrtnat}
\bibliography{references}

\clearpage


\section*{Acronyms}
\renewenvironment{description}%
  {\list{}{\labelwidth0pt\itemindent-\leftmargin
    \parsep-1em\itemsep0pt\let\makelabel\descriptionlabel}}
  {\endlist}
\begin{acronym}
\acro{acmg}[ACMG]{American College of Medical Genetics and Genomics}%
\acro{acat}[ACAT]{Aggregated Cauchy Association Test}%
\acro{ad}[AD]{Autosomal Dominant}%
  \acro{af}[AF]{Allele Frequency}
 \acro{aid}[AID]{Autoinflammatory Disorders}
 \acro{anova}[ANOVA]{Analysis of Variance}
 \acro{ar}[AR]{Autosomal Recessive}
 \acro{bmf}[BMF]{Bone Marrow Failure}
 \acro{cd}[CD]{Complement Deficiencies}
 \acro{ci}[CI]{Confidence Interval}
 \acro{cri}[CrI]{Credible Interval}
 \acro{cid}[CID]{Immunodeficiencies affecting Cellular and Humoral Immunity}
 \acro{cid+}[CID+]{Combined Immunodeficiencies with Associated or Syndromic Features}
 \acro{cf}[CF]{Cystic Fibrosis}
 \acro{cftr}[\textit{CFTR}]{Cystic Fibrosis Transmembrane Conductance Regulator}
 \acro{cvid}[CVID]{Common Variable Immunodeficiency}
  \acro{dclre1c}[\textit{DCLRE1C}]{DNA Cross-Link Repair 1C}
 \acro{dbnsfp}[dbNSFP]{database for Non-Synonymous Functional Predictions}
 \acro{ge}[GE]{Genomics England} 
 \acro{gnomad}[gnomAD]{Genome Aggregation Database}
 \acro{grch38}[GRCh38]{Genome Reference Consortium Human Build 38}
\acro{gvcf}[gVCF]{genomic variant call format}
 \acro{hgvs}[HGVS]{Human Genome Variation Society}
 \acro{hpc}[HPC]{High-Performance Computing}
 \acro{hsd}[HSD]{Honestly Significant Difference}
 \acro{hwe}[HWE]{Hardy-Weinberg Equilibrium}
 \acro{iei}[IEI]{Inborn Errors of Immunity}
  \acro{ig}[Ig]{Immunoglobulin}
 \acro{il2rg}[\textit{IL2RG}]{Interleukin 2 Receptor Subunit Gamma}
 \acro{indel}[InDel]{Insertion/Deletion}
 \acro{iuis}[IUIS]{International Union of Immunological Societies}
 \acro{ld}[LD]{Linkage Disequilibrium}
 \acro{loeuf}[LOEUF]{Loss-Of-function Observed/Expected Upper bound Fraction}
 \acro{lof}[LOF]{Loss-of-Function}
 \acro{moi}[MOI]{Mode of Inheritance}
 \acro{nfkb1}[\textit{NFKB1}]{Nuclear Factor Kappa B Subunit 1}
 \acro{omim}[OMIM]{Online Mendelian Inheritance in Man}
 \acro{pad}[PAD]{Predominantly Antibody Deficiencies}
 \acro{pid}[PID]{Primary Immunodeficiency}
 \acro{pird}[PIRD]{Diseases of Immune Dysregulation}
 \acro{ppi}[PPI]{Protein-Protein Interaction}
 \acro{pli}[pLI]{Probability of being Loss-of-function Intolerant}
 \acro{qc}[QC]{Quality Control}
 \acro{rag1}[\textit{RAG1}]{Recombination activating gene 1}
 \acro{scid}[SCID]{Severe Combined Immunodeficiency}
 \acro{snv}[SNV]{Single Nucleotide Variant}
 \acro{skat}[SKAT]{Sequence Kernel Association Test}
 \acro{stringdb}[STRINGdb]{Search Tool for the Retrieval of Interacting Genes/Proteins}
 \acro{tp}[TP]{true positive}
\acro{fp}[FP]{false positive}
\acro{tn}[TN]{true negative}
\acro{fn}[FN]{false negative}
\acro{tnfaip3}[\textit{TNFAIP3}]{Tumor necrosis factor, alpha-induced protein 3}
 \acro{umap}[UMAP]{Uniform Manifold Approximation and Projection}
 \acro{uniprot}[UniProt]{Universal Protein Resource} 
 \acro{vcf}[VCF]{variant call format}
 \acro{vep}[VEP]{Variant Effect Predictor}
 \acro{vre}[VRE]{variant risk estimate}
 \acro{xl}[XL]{X-Linked}
\end{acronym}

%\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\beginsupplement
\section{Supplemental} \label{Supplemental_text}

Supplemental data are presented under the same headings that correspond to their relevant main text sections. 

\subsection{Occurrence probability across disease genes}

\begin{figure}[h]
  \centering
  \includegraphics[width=0.99\textwidth]{./images/p_gene_summary_hist_patch3.png}
\caption{\textbf{Global distribution of ClinVar clinical-significance classification scoring.} 
(A) Number of variants per gene containing the assigned score for each ClinVar classification term (-5 to +5). 
(B) The same data after normalisation by zero centring the average rank score.
(C) The tally of genes for their average rank and (D) after normalisation. No normalisation was required for the scoring system as shown by comparison of A-C and B-D.}
  \label{fig:p_gene_summary_hist_patch3}
\end{figure}

\clearpage
\subsection{Integrating observed true positives and unobserved false negatives into a single, actionable conclusion}

%\input{"./images/table_scenario_1_quant_uncert_ci.tex"}
%
%\input{"./images/table_scenario_2_quant_uncert_ci.tex"}
%
%\input{"./images/table_scenario_3_quant_uncert_ci.tex"}

\begin{table}[!h]
\centering
\caption{Result of clinical genetics diagnosis scenario 1 including metadata. The most strongly supported observed variant was \texttt{p.Ser237Ter} (posterior: 0.594). The strongest unsequenced variant was \texttt{p.Thr567Ile} (posterior: 0). The total probability of a causal diagnosis given the available evidence was 1 (95\% CI: 1--1).\label{tab:table_scenario_1_quant_uncert_ci}}
\centering
\resizebox{\ifdim\width>\linewidth\linewidth\else\width\fi}{!}{
\begin{tabular}[t]{>{\raggedright\arraybackslash}p{2.5cm}>{\raggedright\arraybackslash}p{1.5cm}>{\raggedright\arraybackslash}p{1.5cm}>{\raggedleft\arraybackslash}p{1.5cm}>{\raggedleft\arraybackslash}p{1.8cm}>{\raggedleft\arraybackslash}p{1.5cm}>{\raggedleft\arraybackslash}p{1.5cm}>{\raggedleft\arraybackslash}p{1.5cm}>{\raggedleft\arraybackslash}p{1.5cm}>{\raggedleft\arraybackslash}p{1.5cm}>{\raggedleft\arraybackslash}p{1.5cm}>{\raggedleft\arraybackslash}p{1.5cm}>{\raggedleft\arraybackslash}p{1.5cm}}
\toprule
Variant & Flag & Class & Evidence Score & Occurrence Prob & Adj Occ Prob & Alpha & Beta & Lower & Median & Upper & Posterior Share & Prob Causal\\
\midrule
p.Ser237Ter & present & causal & 5 & 0.000 & 0 & 6 & 371 & 0.004 & 0.142 & 0.803 & 0.594 & 0.594\\
p.Thr567Ile & missing & other & -5 & 0.002 & 0 & 1 & 363 & NA & NA & NA & 0.000 & 0.000\\
p.Arg231His & present & other & 0 & 0.000 & 0 & 1 & 361 & 0.004 & 0.142 & 0.803 & 0.000 & 0.000\\
p.Gly650Arg & present & other & 0 & 0.000 & 0 & 1 & 379 & 0.004 & 0.142 & 0.803 & 0.000 & 0.000\\
p.Val236Ile & missing & other & 0 & 0.000 & 0 & 1 & 351 & NA & NA & NA & 0.000 & 0.000\\
\addlinespace\\
Total & NA & NA & NA & NA & NA & NA & NA & 1.000 & 1.000 & 1.000 & NA & 1.000\\
\bottomrule
\end{tabular}}
\end{table}

\begin{table}[!h]
\centering
\caption{Result of clinical genetics diagnosis scenario 2 including metadata. The most strongly supported observed variant was \texttt{p.Ser237Ter} (posterior: 0.381). The strongest unsequenced variant was \texttt{c.159+1G>A} (posterior: 0.353). The total probability of a causal diagnosis given the available evidence was 0.52 (95\% CI: 0.248--0.787).\label{tab:table_scenario_2_quant_uncert_ci}}
\centering
\resizebox{\ifdim\width>\linewidth\linewidth\else\width\fi}{!}{
\begin{tabular}[t]{>{\raggedright\arraybackslash}p{2.5cm}>{\raggedright\arraybackslash}p{1.5cm}>{\raggedright\arraybackslash}p{1.5cm}>{\raggedleft\arraybackslash}p{1.5cm}>{\raggedleft\arraybackslash}p{1.8cm}>{\raggedleft\arraybackslash}p{1.5cm}>{\raggedleft\arraybackslash}p{1.5cm}>{\raggedleft\arraybackslash}p{1.5cm}>{\raggedleft\arraybackslash}p{1.5cm}>{\raggedleft\arraybackslash}p{1.5cm}>{\raggedleft\arraybackslash}p{1.5cm}>{\raggedleft\arraybackslash}p{1.5cm}>{\raggedleft\arraybackslash}p{1.5cm}}
\toprule
Variant & Flag & Class & Evidence Score & Occurrence Prob & Adj Occ Prob & Alpha & Beta & Lower & Median & Upper & Posterior Share & Prob Causal\\
\midrule
p.Ser237Ter & present & causal & 5.0 & 0.000 & 0 & 6.0 & 371 & 0.003 & 0.096 & 0.557 & 0.381 & 0.381\\
c.159+1G>A & missing & causal & 4.5 & 0.000 & 0 & 5.5 & 367 & NA & NA & NA & 0.353 & 0.353\\
p.Thr567Ile & missing & other & -5.0 & 0.002 & 0 & 1.0 & 365 & NA & NA & NA & 0.000 & 0.000\\
p.Arg231His & present & other & 0.0 & 0.000 & 0 & 1.0 & 359 & 0.003 & 0.096 & 0.557 & 0.000 & 0.000\\
p.Gly650Arg & present & other & 0.0 & 0.000 & 0 & 1.0 & 349 & 0.003 & 0.096 & 0.557 & 0.000 & 0.000\\
p.Val236Ile & missing & other & 0.0 & 0.000 & 0 & 1.0 & 363 & NA & NA & NA & 0.000 & 0.000\\
\addlinespace\\
Total & NA & NA & NA & NA & NA & NA & NA & 0.248 & 0.520 & 0.787 & NA & 0.520\\
\bottomrule
\end{tabular}}
\end{table}

\begin{table}[!h]
\centering
\caption{Result of clinical genetics diagnosis scenario 3 including metadata. No observed variants were detected in this scenario. The strongest unsequenced variant was \texttt{p.Cys243Arg} (posterior: 0.366). The total probability of a causal diagnosis given the available evidence was 0 (95\% CI: 0--0).\label{tab:table_scenario_3_quant_uncert_ci}}
\centering
\resizebox{\ifdim\width>\linewidth\linewidth\else\width\fi}{!}{
\begin{tabular}[t]{>{\raggedright\arraybackslash}p{2.5cm}>{\raggedright\arraybackslash}p{1.5cm}>{\raggedright\arraybackslash}p{1.5cm}>{\raggedleft\arraybackslash}p{1.5cm}>{\raggedleft\arraybackslash}p{1.8cm}>{\raggedleft\arraybackslash}p{1.5cm}>{\raggedleft\arraybackslash}p{1.5cm}>{\raggedleft\arraybackslash}p{1.5cm}>{\raggedleft\arraybackslash}p{1.5cm}>{\raggedleft\arraybackslash}p{1.5cm}>{\raggedleft\arraybackslash}p{1.5cm}>{\raggedleft\arraybackslash}p{1.5cm}>{\raggedleft\arraybackslash}p{1.5cm}}
\toprule
Variant & Flag & Class & Evidence Score & Occurrence Prob & Adj Occ Prob & Alpha & Beta & Lower & Median & Upper & Posterior Share & Prob Causal\\
\midrule
p.Cys243Arg & missing & causal & 5.0 & 0.000 & 0.000 & 6 & 341 & NA & NA & NA & 0.366 & 0.366\\
p.Tyr246Ter & missing & causal & 4.0 & 0.000 & 0.000 & 5 & 369 & NA & NA & NA & 0.284 & 0.284\\
p.Lys304Glu & missing & other & -5.0 & 0.000 & 0.000 & 1 & 353 & NA & NA & NA & 0.000 & 0.000\\
p.Ile207Leu & missing & other & -4.5 & 0.000 & 0.000 & 1 & 359 & NA & NA & NA & 0.000 & 0.000\\
p.His646Pro & missing & other & 0.0 & 0.002 & 0.001 & 1 & 377 & NA & NA & NA & 0.000 & 0.000\\
p.Arg280Trp & missing & other & -4.0 & 0.000 & 0.000 & 1 & 357 & NA & NA & NA & 0.000 & 0.000\\
p.Thr635Ile & missing & other & 0.0 & 0.000 & 0.000 & 1 & 349 & NA & NA & NA & 0.000 & 0.000\\
p.Arg162Trp & missing & other & 0.0 & 0.000 & 0.000 & 1 & 369 & NA & NA & NA & 0.000 & 0.000\\
\addlinespace\\
Total & NA & NA & NA & NA & NA & NA & NA & 0 & 0 & 0 & NA & 0.000\\
\bottomrule
\end{tabular}}
\end{table}

\begin{figure}[h]
  \centering
  \includegraphics[width=0.99\textwidth]{./images/plot_scenario_1_quant_uncert_ci.pdf}
  \caption{
 \textbf{Quantification of present (\ac{tp}) and no missing (\ac{fn}) causal genetic variants for disease in \ac{nfkb1} (scenario 1)}.
  Only one known pathogenic variant, \texttt{p.Ser237Ter}, was observed and all previously reported pathogenic positions were successfully sequenced and confirmed as reference (true negatives).  
  Panels (A-F) follow the same structure as scenario 2 described in \textbf{Figure \ref{fig:plot_scenario_2_quant_uncert_ci}}, culminating in a gene-level posterior probability of 1 (95\,\% \ac{cri}: 0.99-1.00), with full support assigned to the observed allele given the available evidence. Pathogenicity scores (-5 to +5) are annotated.
  }
  \label{fig:plot_scenario_1_quant_uncert_ci}
\end{figure}

\begin{figure}[h]
  \centering
  \includegraphics[width=0.99\textwidth]{./images/plot_scenario_3_quant_uncert_ci.pdf}
  \caption{
 \textbf{Quantification of no present (\ac{tp}) in \ac{nfkb1} and only missing (\ac{fn}) causal genetic variants for disease in \ac{tnfaip3} (scenario 3)}.
No known causal variants were observed in \ac{nfkb1}, but one representative unsequenced allele was selected from each distinct ClinVar classification and treated as a potential false negative.  
Panels (A-F) follow the same structure as scenario 2 described in \textbf{Figure \ref{fig:plot_scenario_2_quant_uncert_ci}}.  
The posterior reflects uncertainty across multiple plausible but unobserved variants, resulting in low \ac{cri} (0-0) and 100\% missing overall attribution in contrast to scenarios where known pathogenic variants were observed. For this patient, we have no evidence of a causal variant since the only top candidates are not yet accounted for.
Pathogenicity scores (-5 to +5) are annotated in (A).
  }
  \label{fig:plot_scenario_3_quant_uncert_ci}
\end{figure}

% \FloatBarrier
\clearpage











\subsection{Validation studies}
\subsubsection{Validation of dominant disease occurrence with \textit{NFKB1}}

To validate our genome-wide probability estimates for \ac{ad} disorders, we focused on \ac{nfkb1}.
We used a reference dataset from \citet{tuijnenburgNFKB12018}, in which whole-genome sequencing of 846 \ac{pid} patients identified \ac{nfkb1} as one of the genes most strongly associated with the disease, with 16 \ac{nfkb1}-related \ac{cvid} cases attributed to \ac{ad} heterozygous variants. 
Our goal was to compare the predicted number of \ac{nfkb1}-related \ac{cvid} cases with the reported count in this well-characterised national-scale cohort.

Our model calculated 0 known pathogenic variant \ac{nfkb1}-related \ac{cvid} cases in the UK with a minimal risk of 456 unknown de novo variants. In the reference cohort, 16 \ac{nfkb1} \ac{cvid} cases were reported. 
We additionally wanted to account for potential under-reporting in the reference study. 
We used an extrapolated national \ac{cvid} prevalence which yielded a median estimate of 118 cases (95\% CI: 70-181), while a Bayesian-adjusted mixture estimate produced a median of 67 cases (95\% CI: 43-99). \textbf{Figure \ref{fig:validation_studies_bayesian_adjusted_estimates} (A)} illustrates that our predicted values reflect these ranges and are closer to the observed count. 
This case supports the validity of our integrated probability estimation framework for \ac{ad} disorders, and represents a challenging example where pathogenic \ac{snv} are not reported in the reference population of gnomAD. Our min-max values successfully contained the true reported values.

\begin{figure}[h]
  \centering
  \includegraphics[width=0.99\textwidth]{./images/validation_studies_bayesian_adjusted_estimates.png}
  \caption{\textbf{Prior probabilities compared to validation disease cohort metrics.}
  (A) Density distributions for the number of \ac{nfkb1}-related \ac{cvid} cases in the UK. 
  Our model (green) predicted 456 cases, which falls between the observed cohort count (red) of 390 and the upper extrapolated values.
  The blue curve represents maximum count of 1280, and the orange curve shows the Bayesian-adjusted mixture estimate of 835. 
(B) Density distributions for \ac{cftr}-related \texttt{p.Arg117His} \ac{cf} cases. 
Our model (green) predicted 648 biallelic cases and 808 total cases.
The nationally reported case count (red) was 714.
The blue curve represents maximum extrapolated count of 740, and the orange curve shows the Bayesian-adjusted mixture estimate of 727. We observed close agreement among the reported disease cases and our integrated probability estimation framework.}
  \label{fig:validation_studies_bayesian_adjusted_estimates}
\end{figure}

% \FloatBarrier
\subsubsection{Validation of recessive disease occurrence with \textit{CFTR}}

Our analysis predicted the number of \ac{cf} cases attributable to carriage of the \texttt{p.Arg117His} variant (either as homozygous or as compound heterozygous with another pathogenic allele) in the UK. Based on \ac{hwe} calculations and mortality adjustments, we predicted approximately 648 cases arising from biallelic variants and 160 cases from homozygous variants, resulting in a total of 808 expected cases.

In contrast, the nationally reported number of \ac{cf} cases was 714, as recorded in the UK Cystic Fibrosis Registry 2023 Annual Data Report
\cite{naito2023uk}. To account for factors such as reduced penetrance and the mortality-adjusted expected genotype, we derived a Bayesian-adjusted estimate via posterior simulation. Our Bayesian approach yielded a median estimate of 740 cases (95\% \ac{ci}: 696, 786) and a mixture-based estimate of 727 cases (95\% \ac{ci}: 705, 750).
\textbf{Figure \ref{fig:validation_studies_bayesian_adjusted_estimates} (B)} illustrates the close concordance between the predicted values, the Bayesian-adjusted estimates, and the national report supports the validity of our approach for estimating disease.

\textbf{Figure \ref{fig:validation_scatter_dense}} shows the final values for these genes of interest in a given population size and phenotype. It reveals that an allele frequency threshold of approximately 0.000007 is required to observe a single heterozygous carrier of a disease-causing variant in the UK population for both genes. However, owing to the \ac{ar} \ac{moi} pattern of \ac{cftr}, this threshold translates into more than 100,000 heterozygous carriers, compared to only 456 carriers for the \ac{ad} gene \ac{nfkb1}. Note that this allele frequency threshold, being derived from the current reference population, represents a lower bound that can become more precise as public datasets continue to grow. This marked difference underscores the significant impact of \ac{moi} patterns on population carrier frequencies and the observed disease prevalence.

\begin{figure}[h]
  \centering
  \includegraphics[width=\textwidth]{./images/validation_studies_scatterdense_expected_prob.png}
  \caption{\textbf{Interpretation of probability of observing a variant classification.} 
 The result from the chosen validation genes \ac{cftr} and \ac{nfkb1} are shown. 
 Case counts are dependant on the population size and phenotype.
(A) The density plots of expected observations by ClinVar clinical significance. 
We then highlight the values for pathogenic variants specifically showing;
(B) the allele frequency versus expected cases in this population size and
(C) the probability of observing at least one event in this population size.}
  \label{fig:validation_scatter_dense}
\end{figure}

% \FloatBarrier
\subsubsection{Interpretation of ClinVar variant occurrences}

\textbf{Figure~\ref{fig:all_genes_combined_bar_charts_mini}} shows  the two validation study \ac{pid} genes, representing \ac{ar} and dominant \ac{moi}. \textbf{Figure~\ref{fig:all_genes_combined_bar_charts_mini} (A)}   illustrates the overall probability of an affected birth by ClinVar variant classification, whereas \textbf{Figure~\ref{fig:all_genes_combined_bar_charts_mini}  (B)}  depicts the total expected number of cases per classification for an example population, here the UK, of approximately 69.4 million. 

\begin{figure}[h]
  \centering
  \includegraphics[width=0.99\textwidth]{./images/all_genes_combined_bar_charts_mini.png}
  \caption{\textbf{Combined bar charts summarising the genome-wide analysis of ClinVar clinical significance for the \ac{pid} gene panel}. Panel (A) shows the overall probability of an affected birth by variant classification, and (B) displays the total expected number of cases per classification, both stratified by gene. These integrated results illustrate the variability in variant observations across genes and underpin our validation of the probability estimation framework.}
  \label{fig:all_genes_combined_bar_charts_mini}
\end{figure}

% \FloatBarrier
\subsubsection{Validation of SCID-specific disease occurrence}

Given that \ac{scid} is a subset of \ac{pid}, our probability estimates reflect the likelihood of observing a genetic variant as a diagnosis when the phenotype is \ac{pid}. 
However, we additionally tested our results against \ac{scid} cohorts in 
 \textbf{Figure \ref{fig:scid_combined}}.
The summarised raw cohort data for SCID-specific gene counts are summarised and compared across countries in \textbf{Figure \ref{fig:scid_gene_comparison}}.
True counts for \textit{IL2RG} and \ac{dclre1c} from ten distinct locations yielded 95\% \ac{ci} surrounding our predicted values. 
For \ac{il2rg}, the prediction was low (approximately 1 case per 1,000,000 \ac{pid}), as expected since loss-of-function variants in this \ac{xl} gene are highly deleterious and rarely observed in gnomAD. In contrast, the predicted value for \ac{rag1} was substantially higher (553 cases per 1,000,000 \ac{pid}) than the observed counts (ranging from 0 to 200). 
We attributed this discrepancy to the lower penetrance and higher background frequency of \ac{rag1} variants in recessive inheritance, whereby reference studies may underreport the true national incidence. 
Overall, we report that agreement within an order of magnitude was tolerable given the inherent uncertainties from reference studies arising from variable penetrance and allele frequencies.


\begin{figure}[h]
  \centering
  \includegraphics[width=.6\textwidth]{./images/validation_studies_scid_gene_comparison.pdf}
  \caption{\textbf{SCID-specific gene comparison across regions.} The bar plot shows the prevalence of SCID-related cases (count divided by population) for each gene and country (or region), with numbers printed above the bars representing the actual counts in the original cohort (ranging from 0 to 11 per region and gene).}
  \label{fig:scid_gene_comparison}
\end{figure}

\begin{figure}[h]
  \centering
  \includegraphics[width=.6\textwidth]{./images/validation_studies_scid_combined_plot.pdf}
  \caption{\textbf{Combined SCID-specific predictions and observed rates per 1,000,000 PID.}
    The figure presents density distributions for the predicted SCID case counts (per 1,000,000 PID) for three genes: \textit{IL2RG}, \textit{RAG1}, and \ac{dclre1c}. Country-specific rates (displayed as dotted vertical lines) are overlaid with the overall predicted distributions for pathogenic and likely pathogenic variants (solid lines with annotated medians). For \textit{IL2RG}, the low predicted value is consistent with the high deleteriousness of loss-of-function variants in this X-linked gene, while \textit{RAG1} exhibits considerably higher predicted counts, reflecting its lower penetrance in an autosomal recessive context.}
  \label{fig:scid_combined}
\end{figure}

% \FloatBarrier
\clearpage

\subsection{Quantifying variant probabilities improves classification of inborn errors of immunity}
\subsubsection{Genes with high pathogenic variant burden show structured network constraint}
%\subsection{Genetic constraint in high-impact protein networks}
%\subsubsection{Score-positive-total within IEI PPI network}

\begin{figure}[h]
  \centering
  \includegraphics[width=\textwidth]{./images/untangleR_ppi_network_assoc_patch1.jpg}
  \caption{\textbf{\ac{ppi} network and score-positive-total ClinVar significance variants}.
    (A) \ac{ppi} network of disease-associated genes. Node size and colour represent the log-transformed score-positive-total, the top 15 genes/proteins with the highest probability of being observed in disease are labelled.
    (B) Distribution of score-positive-total across the major \ac{iei} disease categories.
    (C) Tukey \ac{hsd} comparisons of mean differences in score-positive-total among all pairwise disease categories. Every 5th label is shown on y-axis.
  }
  \label{fig:ppi_network_assoc}
\end{figure}

\clearpage

\subsubsection{Constrained subnetworks reveal distinct functional disease signatures}

% \subsubsection*{Complement and bone marrow failure genes cluster within high-burden protein subnetworks}

% \subsubsection*{Gene connectivity and LOEUF constraint reveal pathway-specific intolerance}

\begin{figure}[h]
  \centering
  \includegraphics[width=0.75\textwidth]{./images/untangleR_ppi_network_patch2_cator.pdf}
  \caption{
   \textbf{Hierarchical clustering of enrichment scores.}
    The heatmap displays standardised residuals for major disease categories (x-axis) across network clusters (y-axis). A dendrogram groups similar disease categories, and the bar plot shows the maximum absolute residual per category.  (8) \ac{cd} and (9)\ac{bmf} show the highest vales, indicating significant enrichment or depletion (residuals > |2|). Definitions in \textbf{Box \ref{box:definitions}}.
  }
  \label{fig:patch2}
\end{figure}

% \subsubsection*{Gene connectivity and LOEUF constraint reveal pathway-specific intolerance}

\begin{figure}[h]
  \centering
  \includegraphics[width=0.75\textwidth]{./images/untangleR_ppi_network_p_umap_const.pdf}
  \caption{
   \textbf{Analysis of \ac{ppi} degree versus \ac{loeuf} upper rank with \ac{umap} embedding of the \ac{ppi} network.}
    The relationship between \ac{ppi} degree (size) and \ac{loeuf} upper rank (color) across gene clusters. No clear patterns are evident.
  }
  \label{fig:p_umap_const}
\end{figure}

\begin{figure}[h]
  \centering
  \includegraphics[width=0.99\textwidth]{./images/untangleR_ppi_network_p_cor_spear_rho_sig_clust_patch3.pdf}
  \caption{
    \textbf{Correlation between \ac{ppi} degree and \ac{loeuf} upper rank.} 
    \textbf{(A)} Ananlysis across all genes revealed a weak, significant negative correlation between \ac{ppi} degree and \ac{loeuf} upper rank. \textbf{(B)} The cluster-wise analysis showed that clusters 2 and 4 exhibited moderate to strong correlations, while other clusters display weak or non-significant relationships. \textbf{(C) and (D)} Shows the new network plots for the significantly enriched clusters based on \ac{gnomad} constraint metrics.
  }
  \label{fig:p_cor_spear_rho_sig_clust_patch3}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.99\textwidth]{./images/fuma_merge.pdf}
\caption{\textbf{Composite Enrichment Profiles for \ac{iei} Gene Sets.} 
We selected the top two enriched clusters (as per \textbf{Figure \ref{fig:p_cor_spear_rho_sig_clust_patch3}}) and performed functional enrichment analysis derived from known disease associations. For each gene set, the left panel displays the proportion of input genes overlapping with a curated gene set, and the right panel shows the \(-\log_{10}\) adjusted p-value from hypergeometric testing. These profiles, stratified by cluster (Cluster 2 and Cluster 4) and by gene set category (GWAScatalog and Immunologic Signatures), highlight distinct enrichment patterns that reflect differential pathogenic variant loads in the \ac{iei} gene panels.}
\label{fig:fuma_merge}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.75\textwidth]{./images/expHeat_FUMA_jobs604419_var_risk_est_cluster_2.png}
\includegraphics[width=0.75\textwidth]{./images/expHeat_FUMA_jobs604403_var_risk_est_cluster_4.png}
\caption{\textbf{Gene Expression Heatmaps for IEI Genes.} GTEx v8 data from 54 tissue types display the average expression per tissue label (log\(_2\) transformed) for the IEI gene panels. Top: Cluster 2; Bottom: Cluster 4.}
\label{fig:expHeatmaps}
\end{figure}

% \FloatBarrier
\clearpage

\subsubsection{Data-driven classifications of PID genes}

\begin{figure}[h]
  \centering
  \includegraphics[width=0.99\textwidth]{./images/plot_patch1.pdf}
 %   \includegraphics[width=0.7\textwidth]{./images/plot_patch_1_v2.pdf}
  \caption{ \textbf{Distribution of immunophenotypic features before and after recategorisation.}
  The original \ac{iuis} \ac{iei} descriptions contain information such as T cell-related
  ``decreased CD8, normal or decreased CD4 cells'' which we recategorise as ``low''.
  The bar plot shows the count of unique labels for each status (normal, not\_normal) across the T cell, B cell, \ac{ig}, and Neutrophil features.}
  \label{fig:immunophenotype_before_after}
\end{figure}

\begin{figure}[h]
  \centering
  \includegraphics[width=0.99\textwidth]{./images/plot_multicat_patch_3_clust_chi.pdf}
  \caption{\textbf{Heatmaps of clinical feature distributions by \ac{ppi} cluster.} The heatmaps display the count of observations for abnormality of each clinical feature (A) T cell, (B) B cell, (C) Immunoglobulin, (D) Neutrophil, in relation to the \ac{ppi} clusters, with p-values from chi-square tests annotated in the titles.}
  \label{fig:plot_multicat_patch_3_clust_chi}
\end{figure}

\begin{figure}[h]
  \centering
  \includegraphics[width=0.99\textwidth]{./images/plot_multicat_performance_combined.pdf}
  \caption{\textbf{Performance comparison of PID classifiers.} Classification predicting \ac{ppi} cluster membership from \ac{iuis} major category, subcategory, and immunological features. (A) Overall accuracy for four rpart models
used to predict \ac{ppi} clustering. The combined model achieves 61.4 \% accuracy, exceeding all simpler approaches. 
Nodes were split to minimize Gini impurity, pruned by cost-complexity (cp = 0.001), and validated via 5‑fold cross‑validation. %Terminal leaves display the assigned cluster and the proportion of genes falling into each group. 
(B-E) The summary statistics from the top model are detailed.  
}
  \label{fig:multicat_performance_combined}
\end{figure}

%\begin{figure}[h]
%  \centering
%  \includegraphics[width=0.99\textwidth]{./images/plot_combined_model_interpret_fine.pdf}
%  \caption{\textbf{Model performance for fine-tuned \ac{pid} classification.} (A) Confusion matrix heatmap comparing observed and predicted \ac{ppi} clusters. (B) Variable importance plot ranking immunophenotypic features contributing to the classifier. (C) Per-class sensitivity and (D) per-class specificity bar plots. These panels collectively demonstrate the performance of the decision tree classifier in stratifying \ac{pid} genes based on immunophenotypic and \ac{ppi} features.}
%  \label{fig:confusion_matrix}
%\end{figure}

% \FloatBarrier
\clearpage

\subsection{Observed variant likelihood is independent of AlphaMissense pathogenicity}

\begin{figure}[h]
  \centering
  \includegraphics[width=0.75\textwidth]{./images/p_alphamissense_kw.pdf}
  \caption{\textbf{Observed Disease Probability by Clinical Classification with AlphaMissense.} The figure displays the Kruskal-Wallis test results for NFKB1 and CFTR, showing no significant differences.}
  \label{fig:alphamissense_kw}
\end{figure}

% \FloatBarrier

\subsection{Integration of variant observation probabilities into the IEI genetics framework}

\begin{figure}[h]
  \centering
  \includegraphics[width=.8\textwidth]{./images/var_risk_est_iei_genetics.png}
  \caption{
    \textbf{Integration of variant probabilities into the \ac{iei} genetics framework.}
    The interface summarises the condensed variant data, with pre-calculated summary statistics and dynamic links to external databases. This integration enables immediate access to detailed variant classifications and prior probabilities for each gene.
  }
  \label{fig:var_risk_est_iei_genetics}
\end{figure}

\end{document}